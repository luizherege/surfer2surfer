<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Surfer 2 Surfer</title>
    <link href="jquery-mobile/styles/surfer.css" rel="stylesheet" />
    <link href="jquery-mobile/styles/jquery.mobile.structure-1.4.0.min.css" rel="stylesheet" />
    <link href="styles/main.css" rel="stylesheet" />

    <script src="cordova.js" type="text/javascript"></script>
    <script type="text/javascript" charset="utf-8" src="scripts/jquery.min.js"></script>
    <script src="jquery-mobile/js/jquery.mobile-1.4.0.min.js" type="text/javascript"></script>
</head>
<body>    
    <div data-role="page" id="login_page">
        <div data-role="header">
        	<h1>Login</h1>           
        </div>
        
        <div id="login_content" data-role="content">
            <label for="basic">Login:</label>
            <input type="text" name="logon_usr" id="logon_usr" value="" />
            <label for="basic">Senha:</label>
            <input type="password" name="logon_senha" id="logon_senha" value="" />
            <div class="ui-grid-a">
                <div class="ui-block-a">
                    <form>
                        <label>
                            <input type="checkbox" id="anon_box" >Anônimo
                        </label>
                    </form>
                </div>
                <div class="ui-block-b"><a data-role="button" id="logon" >Login</a></div>
	   		</div>
            <button class="button" id="cmdLogin">Login Com Facebook</button>
            <a class="button" data-role="button" href="#cadastro_page">Cadastre-se</a>
        </div>
    	    
        <div data-role="footer">
        	<h1>Surfer 2 Surfer</h1>
        </div>
    </div>
    
    <div data-role="page" id="cadastro_page">
        <div data-role="header">
        	<h1>Cadastro</h1>           
        </div>
        
        <div id="cadastro_content" data-role="content">        
                <label for="text-basic">Login:</label>
				<input type="text" name="login_usr" id="login_usr" value="">
                <label for="text-basic">Senha:</label>
				<input type="password" name="senha_usr" id="senha_usr" value="">
            	<label for="text-basic">Confirme a senha:</label>
				<input type="password" name="senha_usr_conf" id="senha_usr_conf" value="">
                <label for="text-basic">Nome:</label>
				<input type="text" name="nome_usr" id="nome_usr" value="">
                <label for="text-basic">E-mail:</label>
				<input type="text" name="mail_usr" id="mail_usr" value="">
                <label for="text-basic">Confirme o e-mail:</label>
				<input type="text" name="mail_usr_conf" id="mail_usr_conf" value="">
                <div class="ui-grid-a">
                    <div class="ui-block-a"><input type="button" name="register" id="register" value="Enviar"></div>
                    <div class="ui-block-b"><a data-role="button" href="#login_page" name="cancel" >Cancelar</a></div>
	   			</div> 
        </div>
    	    
        <div data-role="footer">
        	<h1>Surfer 2 Surfer</h1>
        </div>
    </div>
    
    <div data-role="page" id="user_panel">
        <div data-role="header">
        	<h1>Surfer 2 Surfer</h1>           
        </div>
        
        <div id="user_content" data-role="content">
           <div class="ui-body ui-body-a ui-corner-all">
                      <p>Olá <span id="usr_nome_txt"></span> caso esteja com dificuldade em utilizar o aplicativo por favor clique no botão ajuda.</p>
           </div>
		   <fieldset class="ui-grid-a">
               <div class="ui-block-a"><a data-role="button" href="#favoritos_page" id="fav_button" >Favoritos</a></div>
               <div class="ui-block-b"><a data-role="button" id="help_button" >Ajuda</a></div>               
           </fieldset>
           <a data-role="button" id="list_praias" >Lista das Praias</a>
           
           <div class="ui-corner-all custom-corners">
               <div id="bar_feed" class="ui-bar ui-bar-a">
                   <h3>Comentários Recentes</h3>
               </div>
               <div id="div_feed">
                   <div class="ui-bar ui-bar-a">
                   	<h3>Heading</h3>
                   </div>
                   <div class="ui-body ui-body-a">
                   	<p>Content</p>
                   </div>
                   <div class="ui-bar ui-bar-a">
                   	<h3>Heading</h3>
                   </div>
                   <div class="ui-body ui-body-a">
                   	<p>Content</p>
                   </div> 
                   <div class="ui-bar ui-bar-a">
                   	<h3>Heading</h3>
                   </div>
                   <div class="ui-body ui-body-a">
                   	<p>Content</p>
                   </div> 
                   <div class="ui-bar ui-bar-a">
                   	<h3>Heading</h3>
                   </div>
                   <div class="ui-body ui-body-a">
                   	<p>Content</p>
                   </div> 
                   <div class="ui-bar ui-bar-a">
                   	<h3>Heading</h3>
                   </div>
                   <div class="ui-body ui-body-a">
                   	<p>Content</p>
                   </div> 
                   <div class="ui-bar ui-bar-a">
                   	<h3>Heading</h3>
                   </div>
                   <div class="ui-body ui-body-a">
                   	<p>Content</p>
                   </div> 
               </div> 
           </div>
    	    
        <div data-role="footer">
        	<h1>Surfer 2 Surfer</h1>
        </div>
    </div>
        
    <div data-role="page" id="favoritos_page">
        <div data-role="header">
        	<h1>Cadastro</h1>           
        </div>
        
        <div id="favorito_content" data-role="content">
            <div id="fav_praias_div">
            </div>
            <div>
                <a data-role="button" >Volta</a>
            </div>
        </div>
        
    	    
        <div data-role="footer">
        	<h1>Surfer 2 Surfer</h1>
        </div>
    </div>
    
    <div data-role="page" id="box_estados_pg">
        <div data-role="header">
        	<h1>Estados</h1>
            <!-- Aqui ficará a logo futuramente  -->
        </div>
        
        <div id="box_estados" data-role="content">         
            <!-- Aqui entram os estados -->
        </div>
    	    
        <div data-role="footer">
        	<h1>Surfer 2 Surfer</h1>
        </div>
    </div>
    
    <script>
        var estados;
        var cidades;
        var notas;
		var cores;
		var tam;
		var ajax_array = new Array ();
        
        /*função para receber o json do servidor */
        function estados_receiver( array_estados )
        {
            for ( var i = 0; i < array_estados.length; i++ )
            {
                var estado = document.createElement( "a" );
                var estado_txt = document.createTextNode( array_estados[i].nome_estado );
                
                estado.appendChild( estado_txt );
                
                estado.className = "estado";
               
                estado.setAttribute( "id", "estado_" + array_estados[i].id_estado );
                
                estado.setAttribute( "data-role", "button" );
               
                
                document.getElementById( "box_estados" ).appendChild( estado );
            }
			
			estados = array_estados;
        };
        
        /*função para receber o json do servidor */
        function notas_receiver( array_notas )
        {			
			notas = array_notas;
        };
		
		/*função para receber o json do servidor */
        function tam_receiver( array_tam )
        {			
			tam = array_tam;
        };
		
		/*função para receber o json do servidor */
        function cores_receiver( array_cores )
        {			
			cores = array_cores;
        };
        
        /* função para receber o json do servidor */
        function cidades_receiver( array_cidades )
        {
            for ( var x = 0 ; x < estados.length; x++ )
            {
             	var page = document.createElement( "div" );
                var page_header_div = document.createElement( "div" );
                var page_content = document.createElement( "div" );
                var page_footer_div = document.createElement( "div" );
                var page_header = document.createElement( "header" );
                var page_footer = document.createElement( "header" );
                var page_footer_txt = document.createTextNode( "Surfer 2 Surfer" );
				var page_header_txt = document.createTextNode( estados[x].nome_estado );
                
                page.appendChild( page_header_div );
                page.appendChild( page_content );
                page.appendChild( page_footer_div );
                page_header_div.appendChild( page_header );
                page_footer_div.appendChild( page_footer );
                page_footer.appendChild( page_footer_txt );
				page_header.appendChild( page_header_txt );
                
                page.setAttribute( "data-role", "page" );
                page.setAttribute( "id", "cidades_box_" + estados[x].id_estado  );
                page_content.setAttribute( "data-role", "content" );
                page_content.setAttribute( "id", "cidades_" + estados[x].id_estado );
                page_header_div.setAttribute( "data-role", "header" );
                page_footer_div.setAttribute( "data-role", "header" );
           
            
                document.body.appendChild( page ); 
                
                for ( var i = 0; i < array_cidades.length; i++ )
                { 
					if( array_cidades[i].id_estado > estados[x].id_estado )
					{
						break;
					}
					
					else if( array_cidades[i].id_estado < estados[x].id_estado )
					{
						continue;
					}
					
					else
					{
						var cidade = document.createElement( "a" );
						var cidade_txt = document.createTextNode( array_cidades[i].nome_cidade );
						
						cidade.appendChild( cidade_txt );
		 
						cidade.className = "cidade";
							
						cidade.setAttribute( "data-role", "button" );
                        cidade.setAttribute( "id", "cidade_" + array_cidades[i].id_cidade );
						
						document.getElementById( "cidades_" + array_cidades[i].id_estado ).appendChild( cidade );
					}
                   
                }
                
                /* Botão para voltar de cidade para estados*/
                var back_button = document.createElement( "a" );
                var back_button_txt = document.createTextNode( "Volta" );
                    
                back_button.appendChild( back_button_txt );
                    
                back_button.className = "botao_volta";
                back_button.setAttribute( "data-role", "button" );
                    
                back_button.href = "#box_estados_pg";
                    
                document.getElementById( "cidades_" + estados[x].id_estado ).appendChild( back_button );
                
                /*------*/
                
        		document.getElementById( "estado_" + estados[x].id_estado ).href = "#cidades_box_" + estados[x].id_estado ;
                        
                cidades = array_cidades;
            }
        };
        
        /*Função pra receber o json do servidor*/
        function praias_receiver( array_praias )
        {
            for ( var x = 0 ; x < cidades.length; x++ )
            {
             	var page = document.createElement( "div" );
                var page_header_div = document.createElement( "div" );
                var page_content = document.createElement( "div" );
                var page_footer_div = document.createElement( "div" );
                var page_header = document.createElement( "header" );
                var page_footer = document.createElement( "header" );
                var page_footer_txt = document.createTextNode( "Surfer 2 Surfer" );
				var page_header_txt = document.createTextNode( cidades[x].nome_cidade );
                
                page.appendChild( page_header_div );
                page.appendChild( page_content );
                page.appendChild( page_footer_div );
                page_header_div.appendChild( page_header );
                page_footer_div.appendChild( page_footer );
                page_footer.appendChild( page_footer_txt );
				page_header.appendChild( page_header_txt );
                
                page.setAttribute( "data-role", "page" );
                page.setAttribute( "id", "praias_box_" + cidades[x].id_cidade  );
                page_content.setAttribute( "data-role", "content" );
                page_content.setAttribute( "id", "praias_" + cidades[x].id_cidade );
                page_header_div.setAttribute( "data-role", "header" );
                page_footer_div.setAttribute( "data-role", "header" );
            
                document.body.appendChild( page ); 
                
                for ( var i = 0; i < array_praias.length; i++ )
                { 
					if( array_praias[i].id_cidade > cidades[x].id_cidade )
					{
                        break;
					}
					
					else if( array_praias[i].id_cidade < cidades[x].id_cidade )
					{
						continue;
					}
					
					else
					{
						var praia = document.createElement( "a" );
                        var praia_grid = document.createElement( "div" );
                        var praia_block = document.createElement( "div" );
                        var nota_block = document.createElement( "div" );
                        var nota_button = document.createElement( "a" );   
						var post_comment = document.createElement( "a" );
						var post_comment_node = document.createTextNode ( "Postar Comentário" );
        
                        var praia_comment_collap = document.createElement( "div" );
						var collap_content = document.createElement( "div" );
                        var praia_submit_div = document.createElement( "div" );
						
						var praia_txt = document.createTextNode( array_praias[i].nome_praia );
                        var comment_area = document.createElement( "textarea" );
                        var comment_box = document.createElement( "div" );
                        var comment_submit = document.createElement( "button" );
                        var comment_submit_txt = document.createTextNode ( "Submit Comment" );
                        
						var notas_tam_grid = document.createElement( "div" );
                        var tam_block = document.createElement( "div" );
                        var notas_block = document.createElement( "div" );
						
                        var notas_box = document.createElement( "fieldset" );
						var nota_legenda = document.createElement( "legend" );
						var nota_legenda_txt = document.createTextNode ( "De uma nota a essa praia" );
						
						var tam_onda_box = document.createElement( "fieldset" );
						var tam_onda_legenda = document.createElement( "legend" );
						var tam_onda_legenda_txt = document.createTextNode ( "Tamanho das ondas" );
						
						tam_onda_legenda.appendChild( tam_onda_legenda_txt );
						tam_onda_box.appendChild( tam_onda_legenda );
						
						nota_legenda.appendChild( nota_legenda_txt );
						notas_box.appendChild( nota_legenda );
        
                        for ( var nota = 0 ; nota < notas.length; nota++ )
                        {
                            var nota_radio = document.createElement( "input" );		
							var nota_label = document.createElement ( "label" );
							var nota_txt = document.createTextNode( notas[nota].texto_nota );
                            nota_radio.setAttribute( "name", "nota" );
							nota_radio.setAttribute( "type", "radio" );
							nota_radio.setAttribute( "data-theme", "a" );
                            nota_radio.setAttribute( "class", "nota_" + notas[nota].id_nota );
							nota_radio.setAttribute( "id", "nota_" + array_praias[i].id_praia + "_" + notas[nota].id_nota );
                            nota_radio.setAttribute( "value", notas[nota].id_nota );
							
							nota_label.setAttribute( "for", "nota_" + array_praias[i].id_praia + "_" + notas[nota].id_nota );
							nota_label.appendChild( nota_txt );
                           
						    nota_label.style.color = notas[nota].cor_nota;
                            notas_box.appendChild( nota_radio );
							notas_box.appendChild( nota_label );
                        }
						
						
                        var tam_slide= document.createElement( "input" );								
                        tam_slide.setAttribute( "name", "tam" );
						tam_slide.setAttribute( "type", "range" );
						tam_slide.setAttribute( "data-highlight", "true" );
						tam_slide.setAttribute( "min", tam[0].onda_tam );
						tam_slide.setAttribute( "value", tam[0].onda_tam );
						tam_slide.setAttribute( "max", tam[ (tam.length - 1) ].onda_tam );
						tam_slide.setAttribute( "step", tam[1].onda_tam - tam[0].onda_tam );
						tam_slide.setAttribute( "data-theme", "a" );                        
						tam_slide.setAttribute( "id", "tam_slide_" + array_praias[i].id_praia );                        
						
						tam_onda_box.appendChild( tam_slide );
                        
                        
                        /*collapsible comments */
						collap_content.className = "praia_collap_content";
						collap_content.setAttribute( "id", "praia_collap_content" + array_praias[i].id_praia );
						collap_content.setAttribute( "data-role", "content" );
						collap_content.appendChild( praia_comment_collap );
                        praia_comment_collap.className = "praia_comment_collap";
                        praia_comment_collap.setAttribute( "id", "praia_comment_collap_" + array_praias[i].id_praia );
                        praia_comment_collap.setAttribute( "data-role", "collapsible-set" );
                        comment_box.appendChild( collap_content );
                        /*------*/            
                        
                        /* -- montagem do grid --*/
                        praia_grid.className = "ui-grid-a" + " praia_grid";						
                        praia_grid.setAttribute( "id", "praia_grid_" + array_praias[i].id_praia );						
                        
                        praia_block.className = "ui-block-a";
                        praia_block.setAttribute( "id", "praia_block_" + array_praias[i].id_praia );
                        
                        nota_block.className = "ui-block-b";
                        nota_block.setAttribute( "id", "nota_block_" + array_praias[i].id_praia );
                        
                        nota_button.setAttribute( "data-role", "button" );
                        nota_button.setAttribute( "id", "nota_button_" + array_praias[i].id_praia );
                        nota_button.className = "nota_button" ;
                        /* -- */
                        
                        
                        /* praia e div de comentários */
						notas_box.setAttribute( "data-role", "controlgroup" );				
						notas_box.setAttribute( "id", "nota_box_" + array_praias[i].id_praia  );
						notas_box.className = "nota_box" ;
						
						tam_onda_box.setAttribute( "data-role", "controlgroup" );				
						tam_onda_box.setAttribute( "id", "tam_onda_box_" + array_praias[i].id_praia  );
						tam_onda_box.className = "tam_onda_box" ;
						
						notas_tam_grid.className = "ui-grid-a";
                        notas_tam_grid.setAttribute( "id", "notas_tam_grid_" + array_praias[i].id_praia );
                        
						notas_block.className = "ui-block-a";
                        notas_block.setAttribute( "id", "notas_block_" + array_praias[i].id_praia );
						
						tam_block.className = "ui-block-b";
                        tam_block.setAttribute( "id", "tam_block_" + array_praias[i].id_praia );
						
						notas_block.appendChild( notas_box );
						tam_block.appendChild( tam_onda_box );
						
						notas_tam_grid.appendChild( notas_block );
						notas_tam_grid.appendChild( tam_block );
						
                                                
						praia.appendChild( praia_txt );
						post_comment.appendChild( post_comment_node );
                        comment_submit.appendChild( comment_submit_txt );
						praia_submit_div.className = "praia_submit_div";
						
						comment_box.appendChild ( post_comment );
                        praia_submit_div.appendChild( notas_tam_grid );
                        praia_submit_div.appendChild( comment_area );
                        praia_submit_div.appendChild( comment_submit );
						comment_box.appendChild( praia_submit_div );
		 
						praia.className = "praia";
                        comment_box.className = "comment_box";
                        comment_area.className = "comment_area";
                        comment_submit.className = "comment_submit";
						post_comment.className = "post_comment";
						
						post_comment.setAttribute( "data-role", "button" );
						post_comment.setAttribute( "id", "post_comment_" + array_praias[i].id_praia );
						praia_submit_div.setAttribute( "id", "praia_submit_div_" + array_praias[i].id_praia );					
                        praia.setAttribute( "data-role", "button" );
                        praia.setAttribute( "id", "praia_" + array_praias[i].id_praia );
                        comment_box.setAttribute( "id", "comment_box_" + array_praias[i].id_praia );
                        comment_area.setAttribute( "id", "comment_area_" + array_praias[i].id_praia );
                        comment_submit.setAttribute( "id", "comment_submit_" + array_praias[i].id_praia );
                        /* -- */
                        
						for ( var cor = 0 ; cor < cores.length; cor++ )
						{
						
							var nota_span = document.createElement ( "span" );							
							var nota_node = document.createTextNode ( "0" );
							
							nota_span.setAttribute( "id", "span_" + cor + "_" + array_praias[i].id_praia );
							nota_span.appendChild( nota_node );
							nota_button.appendChild( nota_span );
							nota_span.style.color = cores[cor].nota_cor ;
							
							if ( cor < cores.length - 1  )
							{	
								var nota_sep = document.createElement ( "span" );
								var nota_sep_node = document.createTextNode ( " / " );
								
								nota_sep.appendChild( nota_sep_node );
								nota_button.appendChild( nota_sep );
							}							
						}						
                        
                        praia_block.appendChild( praia );
                        nota_block.appendChild( nota_button );
                        
                        praia_grid.appendChild( praia_block );
                        praia_grid.appendChild( nota_block );
                        
						document.getElementById( "praias_" + array_praias[i].id_cidade ).appendChild( praia_grid );
                        document.getElementById( "praias_" + array_praias[i].id_cidade ).appendChild( comment_box );
					}
                   
                }
                
                /* Botão para voltar de cidade para estados*/
                var back_button = document.createElement( "a" );
                var back_button_txt = document.createTextNode( "Volta" );
                    
                back_button.appendChild( back_button_txt );
                    
                back_button.className = "botao_volta";
                back_button.setAttribute( "data-role", "button" );
                    
                back_button.href = "#cidades_box_" + cidades[x].id_estado;
                    
                document.getElementById( "praias_" + cidades[x].id_cidade ).appendChild( back_button );
                
                /*------*/
                
        		document.getElementById( "cidade_" + cidades[x].id_cidade ).href = "#praias_box_" + cidades[x].id_cidade ;				
            }
        };
		
		/*Função para receber o call de ajax juntamente com o json que contem o id*/
		function ajax_call( json, id )
		{
			$.ajax
				({
					type: 'POST',
					crossDomain: true,
					url: 'http://surfer2surfer.com.br/json_comentarios_praia.php',
					data : json,
					success: function( data )
					{
						var array = JSON.parse( data );
                                
                        for( var com = 0 ; com < array.length; com++ )
                        {
							var cont = false;
							$("#" + "praia_comment_collap_" + id).children( ).each(
								function ( )
								{
									var id_full_com = $(this).attr( 'id' );
											
									var id_ind_com =  id_full_com.lastIndexOf( '_' ) + 1 ;
									var id_com = id_full_com.substr( id_ind_com );
									if( id_com == array[com].com_id.toString( ) )
									{
										cont = true;
										return;
									}
								}
							);
							
							if ( cont == true )
							{
								cont = false;
								continue;
							}
                            
							var comment = document.createElement( "div" );
                            var comment_header = document.createElement( "h3" );
                            var comment_content = document.createElement( "p" );
							var comment_nota_span = document.createElement( "span" );
							var comment_tam_span = document.createElement( "span" );
							var comment_tam_span_txtnode = document.createTextNode( array[com].tam_onda + " --- Nota : " );
							var comment_nota_span_txtnode = document.createTextNode( array[com].nota_texto );
                            var comment_head_txtnode = document.createTextNode( "Comentário : Nº " + array[com].com_id + " --- Tam : "  );
                            var comment_content_txtnode = document.createTextNode( array[com].com_conteudo );                                    
									
                            comment.setAttribute( "data-role", "collapsible" );
							comment.setAttribute( "id", "comment_" + id + "_" + array[com].com_id );
                            comment.className = "comment_collapsible";
							comment_nota_span.className = "comment_type_" + array[com].com_nota_fk.toString ( );
							comment_tam_span.className = "tam_type_" + array[com].tam_id.toString ( );
                            comment_header.appendChild( comment_head_txtnode );
							comment_nota_span.appendChild( comment_nota_span_txtnode );
							comment_tam_span.appendChild( comment_tam_span_txtnode );
							comment_tam_span.appendChild( comment_nota_span );
							comment_header.appendChild( comment_tam_span );
                            comment_content.appendChild( comment_content_txtnode );
                            comment.appendChild( comment_header );
                            comment.appendChild( comment_content );
							comment_nota_span.style.color = array[com].nota_cor ;
                                    
                            document.getElementById( "praia_comment_collap_" + id ).appendChild( comment );
                        }
						
						$("#" + "praia_comment_collap_" + id).trigger('create');
								
						var array_notas_txt = new Array ( );
						
						for ( var cor = 0 ; cor < cores.length; cor++ )
						{
							array_notas_txt.push ( 0 );
						}
								
						$("#" + "praia_comment_collap_" + id).children( ).each(
							function ( )
							{	
								var id_full_com = $(this).attr( 'id' );
								var id_ind_com =  id_full_com.lastIndexOf( '_' ) + 1 ;
								var id_com = id_full_com.substr( id_ind_com );
										
								for ( var cor = 0 ; cor < cores.length; cor++ )
								{
									var type = cor + 1;
									if( $(this).contents( ).find( ".comment_type_" + type.toString( ) ).length == 1 )
									{
										var num = array_notas_txt[cor];
										num++;
										array_notas_txt[cor] = num;
										num_txt = num.toString( );
										document.getElementById( "span_" + cor.toString( ) + "_" + id ).innerHTML = num_txt ;
									}
									
								}
								
							}
						);
					},	
					
					error: function(jqXHR, textStatus, errorThrown) 
					{
						alert( "Erro com o ajax, reporte o erro ao dono do aplicativo.")
					}
				});			
		}
		/*--------------------------------*/
		
		/*função para setar o interval do ajax e por no array para um futuro clearinterval*/
		function ajax_setInterval ( json_string, int_id )
		{
			var ajax_interval = setInterval ( function ( ) { ajax_call ( json_string, int_id.toString( ) ) }, 5000 );
			ajax_array[int_id] = ajax_interval;
		}
		/*--------------------------------*/
		
		/*função para dar clear no interval dentro do array*/
		function ajax_clearInterval ( int_id )
		{
			clearInterval( ajax_array[int_id] );
		}
		/*--------------------------------*/
        /*Função para verificar e-mail */
        function verifyEmail()
        {
            var status = false;     
            var emailRegEx = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i;
                 if (document.getElementById("mail_usr").value.search(emailRegEx) == -1) {
                      alert("Por favor insira um e-mail válido");
                 }
                 else if (document.getElementById("mail_usr").value != document.getElementById("mail_usr_conf").value) {
                      alert("Os e-mails não coincidem.");
                 }
                 else {                      
                      status = true;
                 }
                 return status;
         }
		
        /* Quando o documento der load */
        $( document ).ready(
        	function( )
            {      
               $.mobile.defaultPageTransition = 'none'; 
               $( ".comment_box" ).hide( ); 
			   $( ".praia_submit_div" ).hide( );
               
               $( "#logon" ).click(
                   function ( )
                   {
                       if( document.getElementById("anon_box").checked )
                       {
                          var json_array = 
                           [
                               {                                 		
                                    "usr_login" : "anonimo" ,
                                    "usr_senha" : "anonimo"
                               }
                       	   ]; 
                       }
                       else
                       {
                           var json_array = 
                               [
                                   {                                 		
                                        "usr_login" : document.getElementById("logon_usr").value ,
                                        "usr_senha" : document.getElementById("logon_senha").value
                                   }
                               ];
                       }
                       
                    var json_str = JSON.stringify( json_array );        			
                    $.ajax
					({
                        type: 'POST',
                        crossDomain: true,
                        url: 'http://surfer2surfer.com.br/logon.php',
                        data : json_str,
                        success: function( data )
                        {
                			var json_response = JSON.parse( data );                            
                            if( json_response[0].status == 0 )
                            {
                                 alert(json_response[0].msg);
                                 document.getElementById("logon_usr").value = "";
                                 document.getElementById("logon_senha").value = "";                     
                            }
                            else
                            {                                
                                localStorage.setItem( 'USR_ID', json_response[0].usr_id );
                                localStorage.setItem( 'USR_NOME', json_response[0].usr_nome );
                                localStorage.setItem( 'USR_MAX_FAV', json_response[0].usr_max_fav);                               
                                var json_fav = 
                               	[
                                   {  
                                        "usr_id"	: localStorage.getItem( 'USR_ID' )                                        
                                   }
                               	];
                                
                                var json_fav_str = JSON.stringify( json_fav );
                                
                                $.ajax
                                ({
                                    type: 'POST',
                                    crossDomain: true,
                                    url: 'http://surfer2surfer.com.br/json_lista_fav.php',
                                    data : json_fav_str,
                                    success: function( data )
                                    {
                                        var json_response_fav = JSON.parse( data );
                                        alert( data );
                                        for ( var i = 0; i < json_response_fav.length; i++ )
                                        {    
                                            var praia_fav = document.createElement( "a" );
                                            var praia_grid_fav = document.createElement( "div" );
                                            var praia_block_fav = document.createElement( "div" );
                                            var nota_block_fav = document.createElement( "div" );
                                            var nota_button_fav = document.createElement( "a" );
                                            var praia_txt_fav = document.createTextNode( json_response_fav[i].praia_nome );
                                            
                                            for ( var cor = 0 ; cor < cores.length; cor++ )
                                            {
                                            
                                                var nota_span = document.createElement ( "span" );							
                                                var nota_node = document.createTextNode ( "0" );
                                                
                                                nota_span.setAttribute( "class", "span_" + cor + "_" + json_response_fav[i].fav_praia );
                                                nota_span.appendChild( nota_node );
                                                nota_button_fav.appendChild( nota_span );
                                                nota_span.style.color = cores[cor].nota_cor ;
                                                
                                                if ( cor < cores.length - 1  )
                                                {	
                                                    var nota_sep = document.createElement ( "span" );
                                                    var nota_sep_node = document.createTextNode ( " / " );
                                                    
                                                    nota_sep.appendChild( nota_sep_node );
                                                    nota_button_fav.appendChild( nota_sep );
                                                }							
                                            }
                                            
                                            praia_block_fav.appendChild( praia_fav );
                                            nota_block_fav.appendChild( nota_button_fav );
                                            
                                            praia_grid_fav.appendChild( praia_block_fav );
                                            praia_grid_fav.appendChild( nota_block_fav );                                        
                                            document.getElementById( "fav_praias_div" ).appendChild( praia_grid_fav );
                                        }
                                        
                                    },
                                    error: function(jqXHR, textStatus, errorThrown) 
                                    {
                                        alert( "Erro com o ajax, reporte o erro ao dono do aplicativo.")
                                    }
                                });
								                                
                                $("body").pagecontainer("change", "#favoritos_page");                       
                                document.getElementById("usr_nome_txt").appendChild( document.createTextNode( localStorage.getItem( 'USR_NOME' ) ) );
                                document.getElementById("logon_usr").value = "";
                                document.getElementById("logon_senha").value = ""; 
                            }
                
                        },
                        error: function(jqXHR, textStatus, errorThrown) 
                        {
                            alert( "Erro com o ajax, reporte o erro ao dono do aplicativo.")
                        }
                     });
                   }
               );    
               $( "#register" ).click(
                    function ( )
                    {
                     if ( document.getElementById("senha_usr").value != document.getElementById("senha_usr_conf").value )
                     {
                         alert("As senhas não coincidem.");
                         return;
                     }
                     if( !verifyEmail() )
                        {                            
                            return;
                        }                   
                
                     var json_array = 
                           [
                               {  
                               		"usr_nome"	: document.getElementById("nome_usr").value ,
                                    "usr_login" : document.getElementById("login_usr").value ,
                                    "usr_senha" : document.getElementById("senha_usr").value ,
									"usr_mail" : document.getElementById("mail_usr").value
                               }
                       	   ];
                
            		var json_str = JSON.stringify( json_array );        			
                    $.ajax
					({
                        type: 'POST',
                        crossDomain: true,
                        url: 'http://surfer2surfer.com.br/cadastro_handler.php',
                        data : json_str,
                        success: function( data )
                        {
                			var json_response = JSON.parse( data );
                            alert(json_response[0].msg);
                            if( json_response[0].status == 1 )
                            {
                                 document.getElementById("nome_usr").value = "";
                                 document.getElementById("login_usr").value = "";
                                 document.getElementById("senha_usr").value = "";
                                 document.getElementById("senha_usr_conf").value = "";
                                 document.getElementById("mail_usr").value = "";
                                 document.getElementById("mail_usr_conf").value = "";
                                 $("body").pagecontainer("change", "#login_page");
                            }
                
                        },
                        error: function(jqXHR, textStatus, errorThrown) 
                        {
                            alert( "Erro com o ajax, reporte o erro ao dono do aplicativo.")
                        }
                    });
                });
                        
                
               $( ".praia" ).click(
                   function ( )
                   {
                       var id_full = $( this ).attr( 'id' );
                       var id_ind =  id_full.indexOf( '_' ) + 1 ;
                       var id = id_full.substr( id_ind );
					   var json_array = 
                           [
                               { "praia_id"	: id }
                       	   ];
                       
                       var json_str = JSON.stringify( json_array );
					   
                       var com_str = "comment_box_";
					   
					   if ( $( "#" + com_str + id ).is(":visible") == false )
					   {
							ajax_setInterval( json_str, parseInt( id ) );
							ajax_call( json_str, parseInt( id ) );
							$( "#" + com_str + id ).toggle( );
					   }
					   else
					   {
							ajax_clearInterval ( parseInt( id ) );
							$( "#" + com_str + id ).toggle( );
							$("#comment_submit_" + id ).removeClass('ui-disabled');							
						}
					}					
               );
			   
			    $( ".post_comment" ).click(
                   function ( )
				   {
						var id_full = $( this ).attr( 'id' );
						var id_ind =  id_full.lastIndexOf( '_' ) + 1 ;
						var id = id_full.substr( id_ind );
						$( "#praia_submit_div_" + id ).toggle( );
				   }
				);   
			   
               $( ".comment_submit" ).click(
                   function ( )
                   {
                       var id_full = $( this ).attr( 'id' );
                       var id_ind =  id_full.lastIndexOf( '_' ) + 1 ;
                       var id = id_full.substr( id_ind );
                       var com_str_area = "comment_area_";
					   var tam_id;
					   var tam_onda_com = document.getElementById( "tam_slide_" + id ).value - 0;					   
					   for ( var ta = 0 ; ta < tam.length ; ta++ )
					    {
							var tam_onda_comp = tam[ta].onda_tam - 0;
							if ( tam_onda_com == tam_onda_comp )
							{
								tam_id = tam[ta].id_tam;
							}
							
					    }
                       var json_array = 
                           [
                               { 	"comment_val" : $("#" + com_str_area + id).val( ) ,
                               		"praia_id"	: id,
									"nota_id" : $("input[name*=nota]:checked").val( ),
									"tam_id" : tam_id
                               }
                       	   ];
                       
                       var json_str = JSON.stringify( json_array );
                       
                       request = new XMLHttpRequest( );
                       request.open( "POST", "http://surfer2surfer.com.br/json_handler_comment.php" );
                       request.setRequestHeader( "Content-type", "application/json", true );
                       request.send( json_str );
                       $(this).addClass('ui-disabled');
					   $("#" + com_str_area + id).val( "" );
                   }
               
               ); 
                
            }
        );
 
    </script>
    <script src="http://surfer2surfer.com.br/json_estados.php?callback=estados_receiver"></script>
	<script src="http://surfer2surfer.com.br/tam_ondas.php?callback=tam_receiver"></script>
	<script src="http://surfer2surfer.com.br/json_cores.php?callback=cores_receiver"></script>
    <script src="http://surfer2surfer.com.br/json_notas.php?callback=notas_receiver"></script>
    <script src="http://surfer2surfer.com.br/json_cidades.php?callback=cidades_receiver"></script>
    <script src="http://surfer2surfer.com.br/json_praias.php?callback=praias_receiver"></script>
    <script type="text/javascript" charset="utf-8" src="scripts/jso.js"></script>
    <script type="text/javascript" charset="utf-8" src="scripts/main.js"></script>
    
</body>
</html>
