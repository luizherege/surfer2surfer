<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Surfer 2 Surfer</title>
    <link href="jquery-mobile/styles/surfer.css" rel="stylesheet" />
    <link href="jquery-mobile/styles/jquery.mobile.structure-1.4.0.min.css" rel="stylesheet" />
    <link href="styles/main.css" rel="stylesheet" />

    <script src="cordova.js" type="text/javascript"></script>
    <script type="text/javascript" charset="utf-8" src="scripts/jquery.min.js"></script>
    <script src="jquery-mobile/js/jquery.mobile-1.4.0.min.js" type="text/javascript"></script>
</head>
<body> 

    <div data-role="page" id="login_page">
        <div data-role="header">
        	<h1>Login</h1>           
        </div>
        
        <div id="login_content" data-role="content">
            <label for="basic">Login:</label>
            <input type="text" name="logon_usr" id="logon_usr" value="" />
            <label for="basic">Senha:</label>
            <input type="password" name="logon_senha" id="logon_senha" value="" />
            <div class="ui-grid-a">
                <div class="ui-block-a">
                    <form>
                        <label>
                            <input type="checkbox" id="anon_box" >Anônimo
                        </label>
                    </form>
                </div>
                <div class="ui-block-b"><a data-role="button" id="logon" >Login</a></div>
	   		</div>
            <button class="button" id="cmdLogin">Login Com Facebook</button>
            <a class="button" data-role="button" href="#cadastro_page">Cadastre-se</a>
        </div>
    	    
        <div data-role="footer">
        	<h1>Surfer 2 Surfer</h1>
        </div>
    </div>
    
    <div data-role="page" id="cadastro_page">
        <div data-role="header">
        	<h1>Cadastro</h1>           
        </div>
        
        <div id="cadastro_content" data-role="content">        
                <label for="text-basic">Login:</label>
				<input type="text" name="login_usr" id="login_usr" value="">
                <label for="text-basic">Senha:</label>
				<input type="password" name="senha_usr" id="senha_usr" value="">
            	<label for="text-basic">Confirme a senha:</label>
				<input type="password" name="senha_usr_conf" id="senha_usr_conf" value="">
                <label for="text-basic">Nome:</label>
				<input type="text" name="nome_usr" id="nome_usr" value="">
                <label for="text-basic">E-mail:</label>
				<input type="text" name="mail_usr" id="mail_usr" value="">
                <label for="text-basic">Confirme o e-mail:</label>
				<input type="text" name="mail_usr_conf" id="mail_usr_conf" value="">
                <div class="ui-grid-a">
                    <div class="ui-block-a"><input type="button" name="register" id="register" value="Enviar"></div>
                    <div class="ui-block-b"><a data-role="button" href="#login_page" name="cancel" >Cancelar</a></div>
	   			</div> 
        </div>
    	    
        <div data-role="footer">
        	<h1>Surfer 2 Surfer</h1>
        </div>
    </div>
    
    <div data-role="page" id="user_panel">
        <div data-role="header">
        	<h1>Surfer 2 Surfer</h1>           
        </div>
        
        <div id="user_content" data-role="content">
           <div class="ui-body ui-body-a ui-corner-all">
                      <p>Olá <span id="usr_nome_txt"></span> caso esteja com dificuldade em utilizar o aplicativo por favor clique no botão ajuda.</p>
           </div>
		   <fieldset class="ui-grid-a">
               <div class="ui-block-a"><a data-role="button" href="#favoritos_page" id="fav_button" >Favoritos</a></div>
               <div class="ui-block-b"><a data-role="button" id="help_button" >Ajuda</a></div>               
           </fieldset>
           <a data-role="button" id="list_praias" href="#box_estados_pg" >Lista das Praias</a>
           
           <div class="ui-corner-all custom-corners">
               <div id="bar_feed" class="ui-bar ui-bar-a">
                   <h3>Comentários Recentes</h3>
               </div>
               <div id="div_feed_fav">
                   <div class="ui-bar ui-bar-a">
                   	<h3>Heading</h3>
                   </div>
                   <div class="ui-body ui-body-a">
                   	<p>Content</p>
                   </div>
                   <div class="ui-bar ui-bar-a">
                   	<h3>Heading</h3>
                   </div>
                   <div class="ui-body ui-body-a">
                   	<p>Content</p>
                   </div> 
                   <div class="ui-bar ui-bar-a">
                   	<h3>Heading</h3>
                   </div>
                   <div class="ui-body ui-body-a">
                   	<p>Content</p>
                   </div> 
                   <div class="ui-bar ui-bar-a">
                   	<h3>Heading</h3>
                   </div>
                   <div class="ui-body ui-body-a">
                   	<p>Content</p>
                   </div> 
                   <div class="ui-bar ui-bar-a">
                   	<h3>Heading</h3>
                   </div>
                   <div class="ui-body ui-body-a">
                   	<p>Content</p>
                   </div> 
                   <div class="ui-bar ui-bar-a">
                   	<h3>Heading</h3>
                   </div>
                   <div class="ui-body ui-body-a">
                   	<p>Content</p>
                   </div> 
               </div>               
           </div>            
		</div>
		
        <div data-role="footer">
        	<h1>Surfer 2 Surfer</h1>
        </div>
	</div>
	
    <div data-role="page" id="favoritos_page">
        <div data-role="header">
        	<h1>Cadastro</h1>           
        </div>
        
        <div id="favorito_content" data-role="content">
            <div id="fav_praias_div">
			
            </div>
            <div>
                <a data-role="button" href="#user_panel" >Volta</a>
            </div>
        </div>
        
    	    
        <div data-role="footer">
        	<h1>Surfer 2 Surfer</h1>
        </div>
    </div>
    
    <div data-role="page" id="box_estados_pg">
        <div data-role="header">
        	<h1>Estados</h1>
            <!-- Aqui ficará a logo futuramente  -->
        </div>
        
        <div id="box_estados" data-role="content">         
            <!-- Aqui entram os estados -->
        </div>
    	    
        <div data-role="footer">
        	<h1>Surfer 2 Surfer</h1>
        </div>
    </div>
    
    <div data-role="page" id="praia_profile">
        <div data-role="header">
        	<h1>Praia Tal</h1>
            <!-- Aqui ficará a logo futuramente  -->
        </div>
        
        <div id="profile_content" data-role="content">         
        	<div id="praia_profile_dados" class="ui-body ui-body-a ui-corner-all">
            	<div class="ui-grid-a">
                	<div class="ui-block-a">
                    	<span class="praia_dados">Nome: <span class="praia_dados" id="praia_profile_nome"></span></span><br>
                    	<span class="praia_dados">Cidade: <span class="praia_dados" id="praia_profile_cidade"></span></span>
                	</div>
                	<div class="ui-block-b">
                    	<span class="praia_dados">Estado: <span class="praia_dados" id="praia_profile_estado"></span></span><br>
              			<span class="praia_dados">Notas: <span class="praia_dados" id="praia_profile_notas"></span></span>
                	</div>
            	</div>                
         	</div>
            <div class="ui-corner-all custom-corners">
            	<div id="bar_feed" class="ui-bar ui-bar-a">
               		<h3>Comentários Recentes</h3>
               	</div>
               	<div id="div_feed">
                    
           		</div>
            </div> 
                <form>
                    <div class="ui-grid-a">
                        <div class="ui-block-a" id="nota_profile_notas">
                            <fieldset data-role="controlgroup" id="nota_set">
                            <legend>De uma nota:</legend>                                
                            </fieldset>    
                        </div>
                        <div class="ui-block-b" id="nota_profile_slide">
                            <label for="tam_onda">Tamanho das ondas:</label>   							
                            <a id="nota_profile_hide" data-role= "button" > &#60&#60&#60 </a>
                        </div>
                    </div>                    
                    <textarea name="comment_box" id="comment_box"></textarea>
                    <div class="ui-grid-a">
                        <div class="ui-block-a">
                            <a class="button" data-role="button" >Enviar</a>    
                         </div>
                         <div class="ui-block-b" >
                            <a class="button" data-role="button" href="#user_panel" >Voltar</a>
                         </div>
                   </div>
                </form>
       	 </div>	   
       
    	    
        <div data-role="footer">
        	<h1>Surfer 2 Surfer</h1>
        </div>
    </div>
    
    <script>
        var estados;
        var cidades;
        var notas;
		var cores;
		var tam;
		var ajax_array = new Array ();
        var ajax_array_span = new Array ();
        
        /*função para receber o json do servidor */
        function tam_receiver( array_tam )
        {			
			tam = array_tam;
        };
        
        /*função para receber o json do servidor */
        function cores_receiver( array_cores )
        {			
			cores = array_cores;
        };
        
        /*função para receber o json do servidor */
        function notas_receiver( array_notas )
        {			
			notas = array_notas;
        };
        
        /* função para receber o json do servidor */
        function cidades_receiver( array_cidades )
        {
            cidades = array_cidades;           
        };
        
        function praias_receiver( array_praias )
        {
            praias = array_praias;
        };
        
        /*função para receber o json do servidor */
        function estados_receiver( array_estados )
        {
            var estado_ul = document.createElement( "ul" );
            estado_ul.setAttribute( "data-role", "listview" );
            estado_ul.setAttribute( "data-divider-theme", "a" );
            estado_ul.setAttribute( "data-inset", "true" );            
            estados = array_estados;
            
            for ( var i = 0; i < array_estados.length; i++ )
            {
                var estado = document.createElement( "li" );
                var cidades_div = document.createElement( "div");
            	cidades_div.setAttribute( "class", "ui-body" + " ui-body-a" + " ui-corner-all" );
                cidades_div.setAttribute( "id", "cidades_div_" + array_estados[i].id_estado );
                
                var estado_txt = document.createTextNode( array_estados[i].nome_estado );
                
                estado.appendChild( estado_txt );
                
                estado.className = "estado";               	               
                estado.setAttribute( "id", "estado_" + array_estados[i].id_estado );
                estado.setAttribute( "data-role", "list-divider" );                
               
                estado_ul.appendChild( estado );
                estado_ul.appendChild( cidades_div );
                
            }
			document.getElementById( "box_estados" ).appendChild( estado_ul );
            
            
            for ( var x = 0; x < cidades.length; x++ )
            {
                var cidade_ul = document.createElement( "ul" );                
                cidade_ul.setAttribute( "data-role", "listview" );
                cidade_ul.setAttribute( "data-divider-theme", "a" );
                cidade_ul.setAttribute( "data-inset", "true" );
                
                var cidade_li = document.createElement( "li" );
                var cidade_txt = document.createTextNode( cidades[x].nome_cidade );
                cidade_li.setAttribute( "data-role", "list-divider" );
                cidade_ul.setAttribute( "id", "cidade_ul_" + cidades[x].id_cidade );                
                cidade_li.className = "cidade_li";
                cidade_li.appendChild( cidade_txt );
                cidade_ul.appendChild( cidade_li );
                document.getElementById( "cidades_div_" + cidades[x].id_estado ).appendChild( cidade_ul );                 
            }
            
            for ( var v = 0; v < praias.length; v++ )
            { 
                var praia_li = document.createElement( "li" );
                var praia_grid = document.createElement( "div" );
                var praia_block = document.createElement( "div" );
                var nota_block = document.createElement( "div" );
                var praia = document.createElement( "a" );
                var nota_button = document.createElement( "a" );
                var praia_txt = document.createTextNode( praias[v].nome_praia );
               
                praia.appendChild( praia_txt );
                praia.className = "praia";					
                praia.setAttribute( "data-role", "button" );
                praia.setAttribute( "id", "praia_" + praias[v].id_praia );
                praia_li.appendChild( praia );
                /* span das notas para cada praia da lista*/
                var span_div = document.createElement( "div" );
                span_div.setAttribute( "class", "span_nota" );
                for ( var cor = 0 ; cor < cores.length; cor++ )
                {
                    var nota_span = document.createElement ( "span" );							
                    var nota_node = document.createTextNode ( "0" );
                    nota_span.setAttribute( "class", "span_" + cor + "_" + praias[v].id_praia );
                    nota_span.appendChild( nota_node );
                    span_div.appendChild( nota_span );
                    nota_span.style.color = cores[cor].nota_cor ;
                    if ( cor < cores.length - 1  )
                    {	
                        var nota_sep = document.createElement ( "span" );                       
                        var nota_sep_node = document.createTextNode ( " / " );
                        nota_sep.appendChild( nota_sep_node );
                        span_div.appendChild( nota_sep );
                    }							
				}
                praia.appendChild( span_div );
                document.getElementById( "cidade_ul_" + praias[v].id_cidade ).appendChild( praia_li );
			}
            /* cria span de notas pro profile de todas as praias */
			for ( var cor_p = 0 ; cor_p < cores.length; cor_p++ )
                {
                    var nota_span_prof = document.createElement ( "span" );							
                    var nota_node_prof = document.createTextNode ( "0" );
                    nota_span_prof.setAttribute( "class", "span_" + cor_p + "_" + "prof" );
                    nota_span_prof.appendChild( nota_node_prof );
                    document.getElementById( "praia_profile_notas" ).appendChild( nota_span_prof );
                    nota_span_prof.style.color = cores[cor_p].nota_cor ;
                    if ( cor_p < cores.length - 1  )
                    {	
                        var nota_sep_prof = document.createElement ( "span" );
                        var nota_sep_node_prof = document.createTextNode ( " / " );
                        nota_sep_prof.appendChild( nota_sep_node_prof );
                        document.getElementById( "praia_profile_notas" ).appendChild( nota_sep_prof );
                    }							
				}
            /*cria o fieldset de notas na página de profile da praia */
			for ( var nota = 0 ; nota < notas.length; nota++ )
            {
                var nota_radio = document.createElement( "input" );		
                var nota_label = document.createElement ( "label" );
                var nota_txt = document.createTextNode( notas[nota].texto_nota );
                nota_radio.setAttribute( "name", "nota" );
                nota_radio.setAttribute( "type", "radio" );
                nota_radio.setAttribute( "data-theme", "a" );
                nota_radio.setAttribute( "class", "nota_" + notas[nota].id_nota );
                nota_radio.setAttribute( "id", "nota_" + notas[nota].id_nota );
                nota_radio.setAttribute( "value", notas[nota].id_nota );
                nota_label.setAttribute( "for", "nota_" + notas[nota].id_nota );
                nota_label.appendChild( nota_txt );
                nota_label.style.color = notas[nota].cor_nota;
                document.getElementById( "nota_set" ).appendChild( nota_radio );
                document.getElementById( "nota_set" ).appendChild( nota_label );
            }
			
            /* O slider do tamanho das ondas*/
			var tam_slide= document.createElement( "input" );								
            tam_slide.setAttribute( "name", "tam" );
			tam_slide.setAttribute( "type", "range" );
			tam_slide.setAttribute( "data-highlight", "true" );
			tam_slide.setAttribute( "min", tam[0].onda_tam );
			tam_slide.setAttribute( "value", tam[0].onda_tam );
			tam_slide.setAttribute( "max", tam[ (tam.length - 1) ].onda_tam );
			tam_slide.setAttribute( "step", tam[1].onda_tam - tam[0].onda_tam );
			tam_slide.setAttribute( "data-theme", "a" );                        
			tam_slide.setAttribute( "id", "tam_slide" );
            document.getElementById( "nota_profile_slide" ).insertBefore( tam_slide, document.getElementById( "nota_profile_hide" ) );
        };     
 
        
		
		/*Função para receber o call do ajax para os spans da list*/
		function ajax_call_lista( json, id )
		{
			$.ajax
				({
					type: 'POST',
					crossDomain: true,
					url: 'http://surfer2surfer.com.br/json_comentarios_praia.php',
					data : json,
					success: function( data )
					{	
						var array = JSON.parse( data );
                        var array_notas_txt = new Array ( );
                        
                        for ( var cor = 0 ; cor < cores.length; cor++ )
                        {
                        	array_notas_txt.push ( 0 );
                        }
                        var num_txt
                        for( var com = 0 ; com < array.length; com++ )
                        {
                         	var num = array_notas_txt[ ( array[com].com_nota_fk - 1 ) ];
                            num++;
                            array_notas_txt[(array[com].com_nota_fk -1)] = num;
                            num_txt = num.toString( );
                            $("." + "span_" + ( array[com].com_nota_fk - 1 ).toString( ) + "_" + array[com].com_praia_fk.toString( ) ).each( 
                            	function ( )
                                {
                                	$(this).html( num_txt );                                    
                                }
                            );																				
                        } 
					},	
					
					error: function(jqXHR, textStatus, errorThrown) 
					{
						alert( "Erro com o ajax, reporte o erro ao dono do aplicativo.")
					}
				});			
		}
		/*--------------------------------*/
        
        /*Função parar retirar o ajax dos spans favoritos*/
		function ajax_lista_setInterval ( json_string, int_id )
		{
			var ajax_interval = setInterval ( function ( ) { ajax_call_lista ( json_string, int_id.toString( ) ) }, 5000 );
			ajax_array[int_id] = ajax_interval;
		}
        
        /*Função para receber o call de ajax juntamente com o json que contem o id*/
		function ajax_call( json, id )
		{
			$.ajax
				({
					type: 'POST',
					crossDomain: true,
					url: 'http://surfer2surfer.com.br/json_comentarios_praia.php',
					data : json,
					success: function( data )
					{	
						var array = JSON.parse( data );
                        
                        if( $( "#div_feed" ).children( ).length == 0 )
                        {
                        	for( var com = 0 ; com < array.length; com++ )
                        	{
                                
                                var data_ind =  array[com].com_data.indexOf( ' ' ) + 1 ;
                      		    var data = array[com].com_data.substr( data_ind );
                                
                                if( array[com].usr_nome.indexOf( ' ' ) == -1 )
                                {
                                    var nome = array[com].usr_nome;
                                }
                                else
                                {
                                	var nome_ind =  array[com].usr_nome.indexOf( ' ' ) + 1 ;
                      		    	var nome = array[com].usr_nome.substr( nome_ind );
                                }
                                
                                var comment = document.createElement( "div" );
                                var comment_grid = document.createElement( "div" );
                                var comment_block_a = document.createElement( "div" );
                                var comment_block_b = document.createElement( "div" );
                                var comment_block_c = document.createElement( "div" );
                                
                                var comment_img = document.createElement( "img" );
                                var comment_header_div = document.createElement( "div" );
                                var comment_content_div = document.createElement( "div" );
                                var comment_content = document.createElement( "p" );
                                
                                var tam_div = document.createElement( "div" );
                                var nota_div = document.createElement( "div" );
                                var data_div = document.createElement( "div" );
                                
                                var comment_usr_nome_span = document.createElement( "span" );
                                var comment_nota_span = document.createElement( "span" );
                                var comment_tam_span = document.createElement( "span" );
                                var comment_data_span = document.createElement( "span" );
                                
                                var comment_tam_span_txtnode = document.createTextNode( array[com].tam_onda + " M");
                                var comment_nota_span_txtnode = document.createTextNode( array[com].nota_texto );
                                var comment_usr_nome_span_txtnode = document.createTextNode( nome );
                                var comment_content_txtnode = document.createTextNode( array[com].com_conteudo );
                                var comment_data_txtnode = document.createTextNode( data );
                                
                                comment_grid.setAttribute( "class", "ui-grid-a comment_grid" );
                                comment_block_a.setAttribute( "class", "ui-block-a" );
                                comment_block_b.setAttribute( "class", "ui-block-b" );
                                comment_grid.appendChild( comment_block_a );
                                comment_grid.appendChild( comment_block_b );
                                
                                comment_header_div.appendChild( comment_img ); 
                                comment_block_a.appendChild( comment_header_div );
                                comment_block_a.appendChild( comment_content_div );
                                comment_header_div.setAttribute( "class", "ui-bar ui-bar-a comment_h_div");
                                comment_content_div.setAttribute( "class", "ui-body ui-body-a comment_p_div");
                                comment_img.setAttribute( "src", array[com].usr_foto );
                                comment_img.setAttribute( "class", "comment_img" );
                                comment_img.setAttribute( "border", 0 );
                                comment_header_div.appendChild( comment_usr_nome_span );
                                comment_usr_nome_span.appendChild( comment_usr_nome_span_txtnode );
                                comment_usr_nome_span.setAttribute( "class", "com_nome_span" );                                
                                comment_content_div.appendChild( comment_content );
                                comment_content.appendChild( comment_content_txtnode );
                                
                                comment_block_b.appendChild( tam_div );
                                comment_block_b.appendChild( nota_div );
                                comment_block_b.appendChild( data_div );
                                tam_div.setAttribute( "class", "ui-body ui-body-a span_div_com");
                                tam_div.appendChild( comment_tam_span );
                                comment_tam_span.appendChild( comment_tam_span_txtnode );
                                nota_div.setAttribute( "class", "ui-body ui-body-a span_div_com");
                                nota_div.appendChild( comment_nota_span );
                                comment_nota_span.appendChild( comment_nota_span_txtnode ); 
                                data_div.setAttribute( "class", "ui-body ui-body-a span_div_com");
                                data_div.appendChild( comment_data_span ); 
                                comment_data_span.appendChild( comment_data_txtnode );
                                
                                comment_nota_span.style.color = array[com].nota_cor ;
                                comment_tam_span.setAttribute( "class", "span_com");
                                comment_nota_span.setAttribute( "class", "span_com");
                                comment_data_span.setAttribute( "class", "span_com");                               
                                
                                
                                comment.appendChild( comment_grid );
                                document.getElementById( "div_feed" ).appendChild( comment );
                                $( "#div_feed" ).trigger('create');
                                
                                /*
                                var comment = document.createElement( "div" );
                                var comment_img = document.createElement( "img" );
                                var comment_header_div = document.createElement( "div" );
                                var comment_content_div = document.createElement( "div" );
                                var comment_header = document.createElement( "h3" );
                                var comment_content = document.createElement( "p" );
                                var comment_nota_span = document.createElement( "span" );
                                var comment_tam_span = document.createElement( "span" );
                                var comment_tam_span_txtnode = document.createTextNode( array[com].tam_onda + " --- Nota : " );
                                var comment_nota_span_txtnode = document.createTextNode( array[com].nota_texto );
                                var comment_head_txtnode = document.createTextNode( "Comentário : Nº " + array[com].com_id + " --- Tam : "  );
                                var comment_content_txtnode = document.createTextNode( array[com].com_conteudo ); 
                                
                                comment.setAttribute( "id", "div_com_" + array[com].com_id  );
                                comment_img.setAttribute( "src", array[com].usr_foto );
                                comment_img.setAttribute( "class", "comment_img" );
                                comment_header_div.appendChild( comment_header );
                                comment_header_div.setAttribute( "class", "ui-bar ui-bar-a");
                                comment_nota_span.className = "comment_type_" + array[com].com_nota_fk.toString ( );
                                comment_tam_span.className = "tam_type_" + array[com].tam_id.toString ( );
                                comment_header.appendChild( comment_img );
                                comment_header.appendChild( comment_head_txtnode );
                                comment_nota_span.appendChild( comment_nota_span_txtnode );
                                comment_tam_span.appendChild( comment_tam_span_txtnode );
                                comment_tam_span.appendChild( comment_nota_span );
                                comment_header.appendChild( comment_tam_span );
                                comment_content.appendChild( comment_content_txtnode );
                                comment_content_div.appendChild( comment_content );
                                comment_content_div.setAttribute( "class", "ui-body ui-body-a");
                                
                                comment.appendChild( comment_header_div );
                                comment.appendChild( comment_content_div );
                                comment_nota_span.style.color = array[com].nota_cor ;
                                        
                                document.getElementById( "div_feed" ).appendChild( comment );
                                $( "#div_feed" ).trigger('create');*/
                            }  
                        }                        
					},	
					
					error: function(jqXHR, textStatus, errorThrown) 
					{
						alert( "Erro com o ajax, reporte o erro ao dono do aplicativo.")
					}
				});			
		}
		/*--------------------------------*/
        
        /*Call para o span do profila*/
		function call_span_profile( json, id )
		{
			$.ajax
				({
					type: 'POST',
					crossDomain: true,
					url: 'http://surfer2surfer.com.br/json_comentarios_praia.php',
					data : json,
					success: function( data )
					{	
						var array = JSON.parse( data );
                        var array_notas_txt = new Array ( );                     
                        
                        for ( var cor = 0 ; cor < cores.length; cor++ )
                        {
                        	array_notas_txt.push ( 0 );
                        }
                        var num_txt
                        for( var com = 0 ; com < array.length; com++ )
                        {
                         	var num = array_notas_txt[ ( array[com].com_nota_fk - 1 ) ];
                            num++;
                            array_notas_txt[(array[com].com_nota_fk -1)] = num;
                            num_txt = num.toString( );
                            $("." + "span_" + ( array[com].com_nota_fk - 1 ).toString( ) + "_" + array[com].com_praia_fk.toString( ) ).each( 
                            	function ( )
                                {
                                	$(this).html( num_txt );
                                    $("." + "span_" + ( array[com].com_nota_fk - 1 ).toString( ) + "_prof" ).html( num_txt );                                    
                                }
                            );																				
                        } 
					},	
					
					error: function(jqXHR, textStatus, errorThrown) 
					{
						alert( "Erro com o ajax, reporte o erro ao dono do aplicativo.")
					}
				});			
		}
		/*--------------------------------*/
		
		/*função para setar o interval do ajax e por no array para um futuro clearinterval*/
		function ajax_setInterval ( json_string, int_id )
		{
			var ajax_interval = setInterval ( function ( ) { ajax_call ( json_string, int_id.toString( ) ) }, 5000 );
			ajax_array[int_id] = ajax_interval;
			
		}
		/*--------------------------------*/
        
        /*função para setar o interval do ajax e por no array para um futuro clearinterval*/
		function ajax_setInterval_span ( json_string, int_id )
		{
			var ajax_interval_span = setInterval ( function ( ) { call_span_profile ( json_string, int_id.toString( ) ) }, 5000 );
			ajax_array_span[int_id] = ajax_interval_span;
			
		}
		/*--------------------------------*/
		
		/*função para dar clear no interval dentro do array*/
		function ajax_clearInterval ( int_id )
		{
			clearInterval( ajax_array[int_id] );	
		}
		/*--------------------------------*/
        
        /*função para dar clear no interval dentro do array*/
		function ajax_clearInterval_span ( int_id )
		{
			clearInterval( ajax_array_span[int_id] );	
		}
		/*--------------------------------*/
        
        /*Função para verificar e-mail */
        function verifyEmail()
        {
            var status = false;     
            var emailRegEx = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i;
                 if (document.getElementById("mail_usr").value.search(emailRegEx) == -1) {
                      alert("Por favor insira um e-mail válido");
                 }
                 else if (document.getElementById("mail_usr").value != document.getElementById("mail_usr_conf").value) {
                      alert("Os e-mails não coincidem.");
                 }
                 else {                      
                      status = true;
                 }
                 return status;
         }
		
        /* Quando o documento der load */
        $( document ).ready(
        	function( )
            {      
               $.mobile.defaultPageTransition = 'none'; 
               $( ".comment_box" ).hide( ); 
			   $( ".praia_submit_div" ).hide( );
               localStorage.setItem( 'profile_notas', 1 );
               
               $( "#logon" ).click(
                   function ( )
                   {
                       if( document.getElementById("anon_box").checked )
                       {
                          var json_array = 
                           [
                               {                                 		
                                    "usr_login" : "anonimo" ,
                                    "usr_senha" : "anonimo"
                               }
                       	   ]; 
                       }
                       else
                       {
                           var json_array = 
                               [
                                   {                                 		
                                        "usr_login" : document.getElementById("logon_usr").value ,
                                        "usr_senha" : document.getElementById("logon_senha").value
                                   }
                               ];
                       }
                       
                    var json_str = JSON.stringify( json_array );        			
                    $.ajax
					({
                        type: 'POST',
                        crossDomain: true,
                        url: 'http://surfer2surfer.com.br/logon.php',
                        data : json_str,
                        success: function( data )
                        {
                			var json_response = JSON.parse( data );                            
                            if( json_response[0].status == 0 )
                            {
                                 alert(json_response[0].msg);
                                 document.getElementById("logon_usr").value = "";
                                 document.getElementById("logon_senha").value = "";                     
                            }
                            else
                            {                                
                                localStorage.setItem( 'USR_ID', json_response[0].usr_id );
                                localStorage.setItem( 'USR_NOME', json_response[0].usr_nome );
                                localStorage.setItem( 'USR_MAX_FAV', json_response[0].usr_max_fav);                               
                                var json_fav = 
                               	[
                                   {  
                                        "usr_id": localStorage.getItem( 'USR_ID' )                                        
                                   }
                               	];
                                
                                var json_fav_str = JSON.stringify( json_fav );
                                
                                $.ajax
                                ({
                                    type: 'POST',
                                    crossDomain: true,
                                    url: 'http://surfer2surfer.com.br/json_lista_fav.php',
                                    data : json_fav_str,
                                    success: function( data )
                                    {
                                        var json_response_fav = JSON.parse( data );
                                        
                                        for ( var i = 0; i < json_response_fav.length; i++ )
                                        {    
                                            var praia_fav = document.createElement( "a" );
                                            var praia_grid_fav = document.createElement( "div" );
                                            var praia_block_fav = document.createElement( "div" );
                                            var nota_block_fav = document.createElement( "div" );
                                            var nota_button_fav = document.createElement( "a" );
                                            var praia_txt_fav = document.createTextNode( json_response_fav[i].praia_nome );									
										
											var json_id_praia_fav = 
											   [
												   { "praia_id"	: json_response_fav[i].fav_praia }
											   ];
                       
                                            var json_id_praia_fav_str = JSON.stringify( json_id_praia_fav );
											ajax_lista_setInterval( json_id_praia_fav_str, parseInt( json_response_fav[i].fav_praia ) );
											ajax_call_lista( json_id_praia_fav_str, parseInt( json_response_fav[i].fav_praia ) );										
											
											praia_fav.appendChild( praia_txt_fav );
											praia_fav.setAttribute( "data-role", "button" );
											nota_button_fav.setAttribute( "data-role", "button" );
											praia_grid_fav.className = "ui-grid-a" + " praia_grid";	
											praia_block_fav.className = "ui-block-a";
											nota_block_fav.className = "ui-block-b";
											
                                            
                                            for ( var cor = 0 ; cor < cores.length; cor++ )
                                            {
                                            
                                                var nota_span = document.createElement ( "span" );							
                                                var nota_node = document.createTextNode ( "0" );
                                                
                                                nota_span.setAttribute( "class", "span_" + cor + "_" + json_response_fav[i].fav_praia );
                                                nota_span.appendChild( nota_node );
                                                nota_button_fav.appendChild( nota_span );
                                                nota_span.style.color = cores[cor].nota_cor ;
                                                
                                                if ( cor < cores.length - 1  )
                                                {	
                                                    var nota_sep = document.createElement ( "span" );
                                                    var nota_sep_node = document.createTextNode ( " / " );
                                                    
                                                    nota_sep.appendChild( nota_sep_node );
                                                    nota_button_fav.appendChild( nota_sep );
                                                }							
                                            }
                                            
                                            praia_block_fav.appendChild( praia_fav );
                                            nota_block_fav.appendChild( nota_button_fav );
                                            
                                            praia_grid_fav.appendChild( praia_block_fav );
                                            praia_grid_fav.appendChild( nota_block_fav );																						
                                            document.getElementById( "fav_praias_div" ).appendChild( praia_grid_fav );											
											$("#" + "fav_praias_div" ).trigger('create');
                                        }
                                        
                                    },
                                    error: function(jqXHR, textStatus, errorThrown) 
                                    {
                                        alert( "Erro com o ajax, reporte o erro ao dono do aplicativo.")
                                    }
                                });
								                                
                                $("body").pagecontainer("change", "#user_panel");                       
                                document.getElementById("usr_nome_txt").appendChild( document.createTextNode( localStorage.getItem( 'USR_NOME' ) ) );
                                document.getElementById("logon_usr").value = "";
                                document.getElementById("logon_senha").value = ""; 
                            }
                
                        },
                        error: function(jqXHR, textStatus, errorThrown) 
                        {
                            alert( "Erro com o ajax, reporte o erro ao dono do aplicativo.");
                        }
                     });
                   });
                
               $( "#register" ).click(
                    function ( )
                    {
                     if ( document.getElementById("senha_usr").value != document.getElementById("senha_usr_conf").value )
                     {
                         alert("As senhas não coincidem.");
                         return;
                     }
                     if( !verifyEmail() )
                        {                            
                            return;
                        }                   
                
                     var json_array = 
                           [
                               {  
                               		"usr_nome"	: document.getElementById("nome_usr").value ,
                                    "usr_login" : document.getElementById("login_usr").value ,
                                    "usr_senha" : document.getElementById("senha_usr").value ,
									"usr_mail" : document.getElementById("mail_usr").value
                               }
                       	   ];
                
            		var json_str = JSON.stringify( json_array );        			
                    $.ajax
					({
                        type: 'POST',
                        crossDomain: true,
                        url: 'http://surfer2surfer.com.br/cadastro_handler.php',
                        data : json_str,
                        success: function( data )
                        {
                			var json_response = JSON.parse( data );
                            alert(json_response[0].msg);
                            if( json_response[0].status == 1 )
                            {
                                 document.getElementById("nome_usr").value = "";
                                 document.getElementById("login_usr").value = "";
                                 document.getElementById("senha_usr").value = "";
                                 document.getElementById("senha_usr_conf").value = "";
                                 document.getElementById("mail_usr").value = "";
                                 document.getElementById("mail_usr_conf").value = "";
                                 $("body").pagecontainer("change", "#login_page");
                            }
                
                        },
                        error: function(jqXHR, textStatus, errorThrown) 
                        {
                            alert( "Erro com o ajax, reporte o erro ao dono do aplicativo.")
                        }
                    });
                });
                        
                
               $( ".praia" ).click(
                   function ( )
                   {
                       var id_full = $( this ).attr( 'id' );
                       var id_ind =  id_full.indexOf( '_' ) + 1 ;
                       var id = id_full.substr( id_ind );
					   var json_array = 
                           [
                               { "praia_id"	: id }
                       	   ];
                       
                       var json_str = JSON.stringify( json_array );
					   ajax_setInterval( json_str, parseInt( id ) );
                       ajax_setInterval_span( json_str, parseInt( id ) );                       
                       call_span_profile( json_str, parseInt( id ) );
					   ajax_call( json_str, parseInt( id ) );
                       $("body").pagecontainer("change", "#praia_profile"); 
				  }
										
               );
                /*
			    $( ".post_comment" ).click(
                   function ( )
				   {
						var id_full = $( this ).attr( 'id' );
						var id_ind =  id_full.lastIndexOf( '_' ) + 1 ;
						var id = id_full.substr( id_ind );
						$( "#praia_submit_div_" + id ).toggle( );
				   }
				);   
			   
               $( ".comment_submit" ).click(
                   function ( )
                   {
                       var id_full = $( this ).attr( 'id' );
                       var id_ind =  id_full.lastIndexOf( '_' ) + 1 ;
                       var id = id_full.substr( id_ind );
                       var com_str_area = "comment_area_";
					   var tam_id;
					   var tam_onda_com = document.getElementById( "tam_slide_" + id ).value - 0;					   
					   for ( var ta = 0 ; ta < tam.length ; ta++ )
					    {
							var tam_onda_comp = tam[ta].onda_tam - 0;
							if ( tam_onda_com == tam_onda_comp )
							{
								tam_id = tam[ta].id_tam;
							}
							
					    }
                       var json_array = 
                           [
                               { 	"comment_val" : $("#" + com_str_area + id).val( ) ,
                               		"praia_id"	: id,
									"nota_id" : $("input[name*=nota]:checked").val( ),
									"tam_id" : tam_id
                               }
                       	   ];
                       
                       var json_str = JSON.stringify( json_array );
                       
                       request = new XMLHttpRequest( );
                       request.open( "POST", "http://surfer2surfer.com.br/json_handler_comment.php" );
                       request.setRequestHeader( "Content-type", "application/json", true );
                       request.send( json_str );
                       $(this).addClass('ui-disabled');
					   $("#" + com_str_area + id).val( "" );
                   }
               
               );
                */
               $( "#nota_profile_hide" ).click( 
                   function ( )
                   {
                       if( localStorage.getItem( 'profile_notas' ) == 1 )
                       {
                           $( "#nota_profile_notas" ).toggle( );
                           $( "#nota_profile_slide" ).animate({width: "100%"}, 100);
                           $( "#nota_profile_notas" ).animate({width: "0%"}, 100);
                           localStorage.setItem( 'profile_notas', 0 );
                           $( "#nota_profile_hide" ).html( "&#62&#62&#62" );
                       }
                       
                       else
                       {
                           $( "#nota_profile_notas" ).toggle( );
                           $( "#nota_profile_slide" ).animate({width: "50%"}, 100);
                           $( "#nota_profile_notas" ).animate({width: "50%"}, 100);
                           localStorage.setItem( 'profile_notas', 1 );
                           $( "#nota_profile_hide" ).html( "&#60&#60&#60" );
                       }
                   }); 
                
            });
 
    </script>
    <script src="http://surfer2surfer.com.br/tam_ondas.php?callback=tam_receiver"></script>
    <script src="http://surfer2surfer.com.br/json_cores.php?callback=cores_receiver"></script>
    <script src="http://surfer2surfer.com.br/json_notas.php?callback=notas_receiver"></script>
    <script src="http://surfer2surfer.com.br/json_praias.php?callback=praias_receiver"></script>
    <script src="http://surfer2surfer.com.br/json_cidades.php?callback=cidades_receiver"></script>
    <script src="http://surfer2surfer.com.br/json_estados.php?callback=estados_receiver"></script>
    <script type="text/javascript" charset="utf-8" src="scripts/jso.js"></script>
    <script type="text/javascript" charset="utf-8" src="scripts/main.js"></script>
    
</body>
</html>
