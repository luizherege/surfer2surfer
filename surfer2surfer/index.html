<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Surfer 2 Surfer</title>
        
        <link href="themes/surfer.css" rel="stylesheet" />
        <link href="jquery-mobile/styles/jquery.mobile.structure-1.4.0.min.css" rel="stylesheet" />
        <link href="themes/jquery.mobile.icons.min.css" rel="stylesheet" />
        
        
        
        <script src="cordova.js" type="text/javascript"></script>
        <script type="text/javascript" charset="utf-8" src="scripts/jquery.min.js"></script>
        <script src="jquery-mobile/js/jquery.mobile-1.4.0.min.js" type="text/javascript"></script>
        
        <link href="styles/main.css" rel="stylesheet" />
    </head>
    <body> 
        
        <div data-role="page" id="login_page">
            <div class="head" data-role="header" style="background-image: url(Fundo_header.png);">
                <h1>Login</h1>
                <img class="logo ui-btn-left" src="logo.png" >  
            </div>
            
            <div id="login_content" data-role="content">  
                <label for="basic">Login:</label>
                <input type="text" name="logon_usr" id="logon_usr" value="" />
                <label for="basic">Senha:</label>
                <input type="password" name="logon_senha" id="logon_senha" value="" />
                <div class="ui-grid-a">
                    <div class="ui-block-a">
                        <form>
                            <label>
                                <input type="checkbox" id="anon_box" >Anônimo
                            </label>
                        </form>
                    </div>
                    <div class="ui-block-b"><a data-role="button" id="logon" >Login</a></div>
                </div>
                <button class="button" id="fbLogin">Login com Facebook</button>
                <a class="button" data-role="button" href="#cadastro_page">Cadastre-se</a>
            </div> 
            
        </div>
        
        <div data-role="page" id="cadastro_page">
            <div data-position="fixed" data-role="header" style="background-image: url(Fundo_header.png);">
                <h1>Cadastro</h1> 
                <a data-role="button" class="ui-btn-right" href="#login_page" name="cancel" >Cancelar</a>
            </div>
            
            <div id="cadastro_content" data-role="content">        
                <label for="text-basic">Login:</label>
                <input type="text" name="login_usr" id="login_usr" value="">
                <label for="text-basic">Senha:</label>
                <input type="password" name="senha_usr" id="senha_usr" value="">
                <label for="text-basic">Confirme a senha:</label>
                <input type="password" name="senha_usr_conf" id="senha_usr_conf" value="">
                <label for="text-basic">Nome:</label>
                <input type="text" name="nome_usr" id="nome_usr" value="">
                <label for="text-basic">E-mail:</label>
                <input type="text" name="mail_usr" id="mail_usr" value="">
                <label for="text-basic">Confirme o e-mail:</label>
                <input type="text" name="mail_usr_conf" id="mail_usr_conf" value="">
                <div class="ui-block-a"><input type="button" name="register" id="register" value="Enviar"></div>
                
            </div>
            
            
        </div>
        
        <div data-role="page" id="user_panel">
            <div data-position="fixed" data-role="header" style="background-image: url(Fundo_header.png);">
                <div class="center-wrapper">                
                    <img class="logo" src="logo.png" >                         
                </div>
                <a data-role="button" onclick="logOut();" class="ui-btn-right"  >Logout</a>    
            </div>
            
            <div id="user_content" data-role="content">
                <div class="ui-body ui-body-a ui-corner-all">
                    <p>Olá <span id="usr_nome_txt"></span> caso esteja com dificuldade em utilizar o aplicativo por favor clique no botão ajuda.</p>
                </div>
                <fieldset class="ui-grid-a">
                    <div class="ui-block-a"><a data-role="button"  id="fav_button" >Favoritos</a></div>
                    <div class="ui-block-b"><a data-role="button" id="help_button" >Ajuda</a></div>               
                </fieldset>
                <a data-role="button" id="list_praias" href="#box_estados_pg" >Lista das Praias</a>
                <a data-role="button" id="not_receb" >Receber Notificações</a>
                <a data-role="button" id="not_para" style="display: block;" >Parar Notificações</a>
                <a data-role="button" id="fav_refresh" >Carregar Favoritos</a>                
                <div class="ui-corner-all custom-corners">                   
                    <div id="div_feed_fav">
                        
                    </div>               
                </div>            
            </div>
            
            
        </div>
        
        <div data-role="page" id="favoritos_page">
            <div data-position="fixed" data-role="header" style="background-image: url(Fundo_header.png);">
                <h1>Favoritos</h1>
                <img class="logo ui-btn-left" src="logo.png" >
                <a data-role="button" class="ui-btn-right" href="#user_panel" >Volta</a>
                
            </div>
            
            <div id="favorito_content" data-role="content">
                <div id="fav_praias_div">               			
                </div>
                
            </div>
            
            
        </div>
        
        <div data-role="page"  id="box_estados_pg">
            <div data-position="fixed" data-role="header" style="background-image: url(Fundo_header.png);">
                <a data-role="button" class="ui-btn-right" href="#user_panel" >Voltar</a>
                <img class="logo ui-btn-left" src="logo.png" >  
                <h1>Estados</h1>
                <!-- Aqui ficará a logo futuramente  -->
            </div>
            
            <div id="box_estados" data-role="content">         
                <!-- Aqui entram os estados -->
            </div>
            
        </div>
        
        <div data-role="page" id="praia_profile" >
            <div data-position="fixed" data-role="header" style="background-image: url(Fundo_header.png);">
                <h1 id="prof_header"></h1>
                <!-- Aqui ficará a logo futuramente  -->
                <div id="div_imgs" class="ui-btn-left" >
                    <img data-inline="true" class="logo" src="logo.png" style="float: left;">                    
                </div>
                <a class="button ui-btn-right" data-role="button" onclick="esvaziaProfile();" >Voltar</a>
            </div>
            
            <div id="profile_content" data-role="content">         
                <div id="praia_profile_dados" class="ui-body ui-body-a ui-corner-all">
                    <div class="ui-grid-a">
                        <div class="ui-block-a">
                            <span class="praia_dados">Nome: <span class="praia_dados" id="praia_profile_nome"></span></span><br>
                            <span class="praia_dados">Cidade: <span class="praia_dados" id="praia_profile_cidade"></span></span>
                        </div>
                        <div class="ui-block-b">
                            <span class="praia_dados">Estado: <span class="praia_dados" id="praia_profile_estado"></span></span><br>
                            <span class="praia_dados">Notas: <span class="praia_dados" id="praia_profile_notas"></span></span>
                        </div>
                    </div>                
                </div>
                <a class="com_show_hide" data-role= "button" >Mostrar Comentários</a>
                <div class="ui-corner-all custom-corners" id="feed_cont">                
                    <div id="div_feed">
                        
                    </div>
                    <a class="com_show_hide" data-role= "button" >Mostrar Comentários</a>   
                </div>
                
                <form>
                    <fieldset data-role="controlgroup" id="nota_set">
                        <legend>De uma nota:</legend>                                
                    </fieldset>    
                    <div id="nota_profile_slide">
                        <label for="tam_onda">Tamanho das ondas (Metros):</label>
                    </div>
                    <!-- <label id="anon_com_label">
<input type="checkbox" id="anon_com" >Anônimo
</label> -->                    
                    <label >Comentar/Foto:</label>
                    <textarea name="comment_box" id="comment_box" maxlength="150" ></textarea>
                    <label >Postar:</label>
                    <label id="fb_post_label">
                        <input type="checkbox" id="fb_post" >Facebook
                    </label>
                    <label>
                        <input type="checkbox" id="so_img" >Foto sem Comentário
                    </label>
                    <a id="comment_submit" class="button" data-role="button" >Enviar</a> 
                </form>
            </div>	  
            
        </div>
        
        <div data-role="page" id="loading">
            <div data-role="header" style="background-image: url(Fundo_header.png);">
                <h1>Loading</h1>
                <img class="logo ui-btn-left" src="logo.png" >
            </div>
            
            <div id="loading_content" data-role="content">
                <img id="loading_img" src="loading.gif" >           
            </div>
            
            
        </div>
        
        <script>
            var estados;
            var cidades;
            var notas;
            var cores;
            var praias;
            var tam;
            var ajax_array = new Array ();
            var ajax_array_span = new Array ();
            var ajax_array_fav = new Array ();
            var ajax_array_lista = new Array ( );
            var ajax_array_not = new Array ( );
            var ajax_all = new Array ();
            
            /*função para receber o json do servidor */
            function tam_receiver( array_tam )
            {			
                tam = array_tam;
            };
            
            /*função para receber o json do servidor */
            function cores_receiver( array_cores )
            {			
                cores = array_cores;
            };
            
            /*função para receber o json do servidor */
            function notas_receiver( array_notas )
            {			
                notas = array_notas;
            };
            
            /* função para receber o json do servidor */
            function cidades_receiver( array_cidades )
            {
                cidades = array_cidades;           
            };
            
            function praias_receiver( array_praias )
            {
                praias = array_praias;
            };
            
            /*função para receber o json do servidor */
            function estados_receiver( array_estados )
            {
                estados = array_estados;
                var estado_ul = document.createElement( "ul" );
                estado_ul.setAttribute( "data-role", "listview" );
                estado_ul.setAttribute( "data-divider-theme", "a" );
                estado_ul.setAttribute( "data-inset", "true" );
                estado_ul.setAttribute( "data-filter", "true" );
                estado_ul.setAttribute( "data-filter-placeholder", "Digite o Nome do estado..." );
                
                for ( var i = 0; i < array_estados.length; i++ )
                {
                    var estado_li = document.createElement( "li" );
                    var estado = document.createElement( "a" );
                    var estado_txt = document.createTextNode( array_estados[i].nome_estado );
                    
                    estado_li.className = "estado";               	               
                    estado_li.setAttribute( "id", "estado_" + array_estados[i].id_estado );                               
                    
                    estado_ul.appendChild( estado_li );
                    estado.appendChild( estado_txt );
                    
                    estado.setAttribute( "id", "estado_a_" + array_estados[i].id_estado );
                    
                    estado.setAttribute( "data-role", "button" );
                    estado.setAttribute( "href", "#cidades_box_" + array_estados[i].id_estado );
                    
                    estado_li.appendChild( estado );
                    
                    var page = document.createElement( "div" );
                    var page_header_div = document.createElement( "div" );
                    var page_content = document.createElement( "div" );               
                    var page_header = document.createElement( "h1" );               
                    var page_header_txt = document.createTextNode( array_estados[i].nome_estado );
                    
                    page.appendChild( page_header_div );
                    page.appendChild( page_content );                
                    page_header_div.appendChild( page_header );              
                    page_header.appendChild( page_header_txt );                
                    page.setAttribute( "data-role", "page" );
                    page.setAttribute( "id", "cidades_box_" + array_estados[i].id_estado );
                    page_content.setAttribute( "data-role", "content" );
                    page_content.setAttribute( "id", "cidades_" + array_estados[i].id_estado );
                    
                    page_header_div.setAttribute( "data-role", "header" );
                    page_header_div.setAttribute( "style", "background-image: url(Fundo_header.png);" );
                    page_header_div.setAttribute( "data-position", "fixed" );              
                    
                    var vol_but = document.createElement( "a" );
                    var vol_but_txt = document.createTextNode( "Voltar" );
                    vol_but.setAttribute( "data-role", "button" );
                    vol_but.setAttribute( "class", "ui-btn-right" );
                    vol_but.setAttribute( "href", "#box_estados_pg" );
                    vol_but.appendChild( vol_but_txt );
                    
                    var img_header = document.createElement( "img" );
                    img_header.setAttribute( "class", "logo ui-btn-left" );
                    img_header.setAttribute( "src", "logo.png" );                
                    
                    page_header_div.appendChild( vol_but );
                    page_header_div.appendChild( img_header );
                    
                    document.body.appendChild( page );
                }
                document.getElementById( "box_estados" ).appendChild( estado_ul );
                
                for ( var x = 0; x < cidades.length; x++ )
                {        
                    var cidade_ul = document.createElement( "ul" );                
                    cidade_ul.setAttribute( "data-role", "listview" );
                    cidade_ul.setAttribute( "data-divider-theme", "a" );
                    cidade_ul.setAttribute( "data-inset", "true" );                
                    
                    var cidade_li = document.createElement( "li" );
                    var cidade_txt = document.createTextNode( cidades[x].nome_cidade );
                    cidade_li.setAttribute( "data-role", "list-divider" );
                    cidade_ul.setAttribute( "id", "cidade_ul_" + cidades[x].id_cidade );                
                    cidade_li.className = "cidade_li";
                    cidade_li.appendChild( cidade_txt );
                    cidade_ul.appendChild( cidade_li );
                    document.getElementById( "cidades_box_" + cidades[x].id_estado ).appendChild( cidade_ul );                 
                }
                
                for ( var v = 0; v < praias.length; v++ )
                { 
                    var praia_li = document.createElement( "li" );                
                    var praia = document.createElement( "a" );
                    var nota_button = document.createElement( "a" );
                    var praia_txt = document.createTextNode( praias[v].nome_praia );
                    
                    praia.appendChild( praia_txt );
                    praia.className = "praia";					
                    praia.setAttribute( "data-role", "button" );
                    praia.setAttribute( "id", "praia_" + praias[v].id_praia );
                    praia_li.appendChild( praia );
                    /* span das notas para cada praia da lista*/
                    var span_div = document.createElement( "div" );
                    span_div.setAttribute( "class", "span_nota" );
                    for ( var cor = 0 ; cor < cores.length; cor++ )
                    {
                        var nota_span = document.createElement ( "span" );							
                        var nota_node = document.createTextNode ( "0" );
                        nota_span.setAttribute( "class", "span_" + cor + "_" + praias[v].id_praia );
                        nota_span.appendChild( nota_node );
                        span_div.appendChild( nota_span );
                        nota_span.style.color = cores[cor].nota_cor ;
                        if ( cor < cores.length - 1  )
                        {	
                            var nota_sep = document.createElement ( "span" );                       
                            var nota_sep_node = document.createTextNode ( " / " );
                            nota_sep.appendChild( nota_sep_node );
                            span_div.appendChild( nota_sep );
                        }							
                    }
                    praia.appendChild( span_div );
                    document.getElementById( "cidade_ul_" + praias[v].id_cidade ).appendChild( praia_li );
                }
                /* cria span de notas pro profile de todas as praias */
                for ( var cor_p = 0 ; cor_p < cores.length; cor_p++ )
                {
                    var nota_span_prof = document.createElement ( "span" );							
                    var nota_node_prof = document.createTextNode ( "0" );
                    nota_span_prof.setAttribute( "class", "span_" + cor_p + "_" + "prof" );
                    nota_span_prof.appendChild( nota_node_prof );
                    document.getElementById( "praia_profile_notas" ).appendChild( nota_span_prof );
                    nota_span_prof.style.color = cores[cor_p].nota_cor ;
                    if ( cor_p < cores.length - 1  )
                    {	
                        var nota_sep_prof = document.createElement ( "span" );
                        var nota_sep_node_prof = document.createTextNode ( " / " );
                        nota_sep_prof.appendChild( nota_sep_node_prof );
                        document.getElementById( "praia_profile_notas" ).appendChild( nota_sep_prof );
                    }							
                }
                /*cria o fieldset de notas na página de profile da praia */
                for ( var nota = 0 ; nota < notas.length; nota++ )
                {
                    var nota_radio = document.createElement( "input" );		
                    var nota_label = document.createElement ( "label" );
                    var nota_txt = document.createTextNode( notas[nota].texto_nota );
                    nota_radio.setAttribute( "name", "nota" );
                    nota_radio.setAttribute( "type", "radio" );
                    nota_radio.setAttribute( "data-theme", "a" );
                    nota_radio.setAttribute( "class", "nota_" + notas[nota].id_nota );
                    nota_radio.setAttribute( "id", "nota_" + notas[nota].id_nota );
                    nota_radio.setAttribute( "value", notas[nota].id_nota );
                    nota_label.setAttribute( "for", "nota_" + notas[nota].id_nota );
                    nota_label.appendChild( nota_txt );
                    nota_label.style.color = notas[nota].cor_nota;
                    document.getElementById( "nota_set" ).appendChild( nota_radio );
                    document.getElementById( "nota_set" ).appendChild( nota_label );
                }
                
                /* O slider do tamanho das ondas*/
                var tam_slide= document.createElement( "input" );								
                tam_slide.setAttribute( "name", "tam" );
                tam_slide.setAttribute( "type", "range" );
                tam_slide.setAttribute( "data-highlight", "true" );
                tam_slide.setAttribute( "min", tam[0].onda_tam );
                tam_slide.setAttribute( "value", tam[0].onda_tam );
                tam_slide.setAttribute( "max", tam[ (tam.length - 1) ].onda_tam );
                tam_slide.setAttribute( "step", tam[1].onda_tam - tam[0].onda_tam );
                tam_slide.setAttribute( "data-theme", "a" );                        
                tam_slide.setAttribute( "id", "tam_slide" );
                document.getElementById( "nota_profile_slide" ).insertBefore( tam_slide, document.getElementById( "nota_profile_hide" ) );
            };
            
            /* função esvazia fav */
            function esvaziaFav ( )
            {
                var feed_fav = document.getElementById("div_feed_fav");
                while (feed_fav.firstChild) 
                {
                    feed_fav.removeChild(feed_fav.firstChild);
                }
                
                var fav_praias_div = document.getElementById("fav_praias_div");
                while (fav_praias_div.firstChild) 
                {
                    fav_praias_div.removeChild(fav_praias_div.firstChild);
                }                
                
                for( var fav = 0 ; fav < ajax_array_fav.length ; fav++ )
                {
                    clearInterval ( ajax_array_fav[fav] );
                }
                
                for( var lis = 0 ; lis < ajax_array_lista.length ; lis++ )
                {
                    clearInterval ( ajax_array_lista[lis] );
                }
            }
            
            /*função dos clicks das wave_img */
            function wave_click ( )
            {
                if( $( this ).attr( "src" ) == "fav_greyed.png" )
                {                      
                    var json_fav = 
                        [
                            {  
                                "fav_usr": localStorage.getItem( 'USR_ID' ) ,
                                "fav_praia" : localStorage.getItem( "CUR_PRAIA" )
                                
                            }
                        ];
                    
                    var json_str = JSON.stringify( json_fav );
                    
                    $.ajax
                    ({
                        type: 'POST',
                        crossDomain: true,
                        url: 'http://surfer2surfer.com.br/json_fav_new.php',
                        data : json_str,
                        success: function( data )
                        {
                            var json_fav = JSON.parse( localStorage.getItem( "FAV_LIST" ) );
                            var cur_int = parseInt( localStorage.getItem( "CUR_PRAIA" ) );
                            json_fav[ cur_int ] = 1;
                            var json_fav_str = JSON.stringify( json_fav );
                            localStorage.setItem( "FAV_LIST", json_fav_str );
                            
                            var praia_profile_img_div = document.getElementById( "div_imgs" );
                            praia_profile_img_div.removeChild( praia_profile_img_div.lastChild );
                            
                            var img_wave = document.createElement( "img" );
                            img_wave.setAttribute( "data-inline", "true" );
                            img_wave.setAttribute( "class", "wave_fav" );
                            img_wave.setAttribute( "id", "wave_icon" );
                            img_wave.setAttribute( "src", "fav_golden.png" );
                            img_wave.setAttribute( "style", "float: right;" );                            
                            
                            document.getElementById( "div_imgs" ).appendChild( img_wave );
                            
                            $( ".wave_fav" ).click( wave_click );
                            esvaziaFav ( );
                            
                            
                            alert( "Praia favoritada com sucesso!" );
                        },
                        
                        error: function(jqXHR, textStatus, errorThrown) 
                        {
                            alert( "Erro com o ajax, por favor verifique a conectividade.")
                        }
                    });
                }
                
                else
                {
                    var json_fav = 
                        [
                            {  
                                "fav_usr": localStorage.getItem( 'USR_ID' ) ,
                                "fav_praia" : localStorage.getItem( "CUR_PRAIA" )
                                
                            }
                        ];
                    
                    var json_str = JSON.stringify( json_fav );
                    
                    $.ajax
                    ({
                        type: 'POST',
                        crossDomain: true,
                        url: 'http://surfer2surfer.com.br/json_fav_del.php',
                        data : json_str,
                        success: function( data )
                        {
                            var json_fav = JSON.parse( localStorage.getItem( "FAV_LIST" ) );
                            var cur_int = parseInt( localStorage.getItem( "CUR_PRAIA" ) );
                            json_fav[ cur_int ] = 0;
                            var json_fav_str = JSON.stringify( json_fav );
                            localStorage.setItem( "FAV_LIST", json_fav_str );
                            
                            var praia_profile_img_div = document.getElementById( "div_imgs" );
                            praia_profile_img_div.removeChild( praia_profile_img_div.lastChild );
                            
                            var img_wave = document.createElement( "img" );
                            img_wave.setAttribute( "data-inline", "true" );
                            img_wave.setAttribute( "class", "wave_fav" );
                            img_wave.setAttribute( "src", "fav_greyed.png" );
                            img_wave.setAttribute( "id", "wave_icon" );
                            img_wave.setAttribute( "style", "float: right;" );                            
                            document.getElementById( "div_imgs" ).appendChild( img_wave );
                            
                            $( ".wave_fav" ).click( wave_click );
                            
                            esvaziaFav ( );                            
                            
                            alert( "Praia desfavoritada com sucesso!" );
                        },
                        
                        error: function(jqXHR, textStatus, errorThrown) 
                        {
                            alert( "Erro com o ajax, por favor verifique a conectividade.")
                        }
                    }); 
                }
            }
            
            /* função logout */
            var logOut = function ( )
            { };
            
            var fbWallPost = function ( response )
            { alert(response); };
            
            
            /* função esvazia profile_praia */
            function esvaziaProfile( )
            {
                var prof_header = document.getElementById("prof_header");
                while (prof_header.firstChild) 
                {
                    prof_header.removeChild(prof_header.firstChild);
                }
                
                var praia_profile_notas = document.getElementById("praia_profile_notas");
                while (praia_profile_notas.firstChild) 
                {
                    praia_profile_notas.removeChild(praia_profile_notas.firstChild);
                }
                
                for ( var cor_p = 0 ; cor_p < cores.length; cor_p++ )
                {
                    var nota_span_prof = document.createElement ( "span" );							
                    var nota_node_prof = document.createTextNode ( "0" );
                    nota_span_prof.setAttribute( "class", "span_" + cor_p + "_" + "prof" );
                    nota_span_prof.appendChild( nota_node_prof );
                    document.getElementById( "praia_profile_notas" ).appendChild( nota_span_prof );
                    nota_span_prof.style.color = cores[cor_p].nota_cor ;
                    if ( cor_p < cores.length - 1  )
                    {	
                        var nota_sep_prof = document.createElement ( "span" );
                        var nota_sep_node_prof = document.createTextNode ( " / " );
                        nota_sep_prof.appendChild( nota_sep_node_prof );
                        document.getElementById( "praia_profile_notas" ).appendChild( nota_sep_prof );
                    }							
                }
                
                var div_feed = document.getElementById("div_feed");
                while (div_feed.firstChild) 
                {
                    div_feed.removeChild(div_feed.firstChild);
                }
                
                var praia_profile_nome = document.getElementById("praia_profile_nome");
                while (praia_profile_nome.firstChild) 
                {
                    praia_profile_nome.removeChild(praia_profile_nome.firstChild);
                }
                
                var praia_profile_cidade = document.getElementById("praia_profile_cidade");
                while (praia_profile_cidade.firstChild) 
                {
                    praia_profile_cidade.removeChild(praia_profile_cidade.firstChild);
                }
                
                var praia_profile_estado = document.getElementById("praia_profile_estado");
                while (praia_profile_estado.firstChild) 
                {
                    praia_profile_estado.removeChild(praia_profile_estado.firstChild);
                }
                
                var wave_icon = document.getElementById( "wave_icon" );
                if( wave_icon != null )
                {
                    wave_icon.parentNode.removeChild( wave_icon );
                }
                
                ajax_clearInterval( localStorage.getItem( "CUR_PRAIA" ) );
                ajax_clearInterval_span( localStorage.getItem( "CUR_PRAIA" ) );
                var id_volta = localStorage.getItem( "VOLTA_ESTADO" );
                var pag_volta = "#cidades_box_" + id_volta ;
                localStorage.setItem( 'profile_com', 1 );
                $( ".com_show_hide" ).html( "Mostrar Comentários" );                
                $( "#feed_cont" ).hide( );
                $("body").pagecontainer( "change", pag_volta );            
            }
            
            function dadosProfile( )
            {
                var minId = praias[0].id_praia;                 
                var span_nomeEstado = document.createElement( "span" );            
                var span_nomeEstado_txtNode = document.createTextNode( praias[ ( localStorage.getItem( "CUR_PRAIA" ) - minId )].nome_estado );
                span_nomeEstado.appendChild( span_nomeEstado_txtNode );
                var span_nomeCidade = document.createElement( "span" );            
                var span_nomeCidade_txtNode = document.createTextNode( praias[ ( localStorage.getItem( "CUR_PRAIA" ) - minId )].nome_cidade );
                span_nomeCidade.appendChild( span_nomeCidade_txtNode );
                var span_nomePraia = document.createElement( "span" );            
                var span_nomePraia_txtNode = document.createTextNode( praias[ ( localStorage.getItem( "CUR_PRAIA" ) - minId )].nome_praia );
                span_nomePraia.appendChild( span_nomePraia_txtNode );
                var span_nomePraiaHead = document.createElement( "span" );            
                var span_nomePraiaHead_txtNode = document.createTextNode( praias[ ( localStorage.getItem( "CUR_PRAIA" ) - minId )].nome_praia );
                span_nomePraiaHead.appendChild( span_nomePraiaHead_txtNode );
                if( localStorage.getItem( 'USR_ID' ) != 1 )
                {
                    var json_fav = JSON.parse( localStorage.getItem( "FAV_LIST" ) );
                    var cur_int = parseInt( localStorage.getItem( "CUR_PRAIA" ) );                
                    if( json_fav[ cur_int ] == 1 )
                    {
                        var img_wave = document.createElement( "img" );
                        img_wave.setAttribute( "data-inline", "true" );
                        img_wave.setAttribute( "class", "wave_fav" );
                        img_wave.setAttribute( "src", "fav_golden.png" );
                        img_wave.setAttribute( "style", "float: right;" );
                        img_wave.setAttribute( "id", "wave_icon" );
                        
                        document.getElementById( "div_imgs" ).appendChild( img_wave );
                    }
                    else
                    {
                        var img_wave = document.createElement( "img" );
                        img_wave.setAttribute( "data-inline", "true" );
                        img_wave.setAttribute( "class", "wave_fav" );
                        img_wave.setAttribute( "src", "fav_greyed.png" );
                        img_wave.setAttribute( "style", "float: right;" );
                        img_wave.setAttribute( "id", "wave_icon" );
                        
                        document.getElementById( "div_imgs" ).appendChild( img_wave );
                    }
                    
                    $( ".wave_fav" ).click( wave_click );
                }
                
                document.getElementById( "praia_profile_estado" ).appendChild( span_nomeEstado );
                document.getElementById( "praia_profile_cidade" ).appendChild( span_nomeCidade );
                document.getElementById( "praia_profile_nome" ).appendChild( span_nomePraia );
                document.getElementById( "prof_header" ).appendChild( span_nomePraiaHead );
            }
            
            /*Função para receber o call do ajax para os spans da list*/
            function ajax_call_lista( json, id )
            {
                $.ajax
                ({
                    type: 'POST',
                    crossDomain: true,
                    url: 'http://surfer2surfer.com.br/json_comentarios_praia.php',
                    data : json,
                    success: function( data )
                    {	
                        var array = JSON.parse( data );
                        var array_notas_txt = new Array ( );
                        
                        for ( var cor = 0 ; cor < cores.length; cor++ )
                        {
                            array_notas_txt.push ( 0 );
                        }
                        var num_txt
                        for( var com = 0 ; com < array.length; com++ )
                        {
                            var num = array_notas_txt[ ( array[com].com_nota_fk - 1 ) ];
                            num++;
                            array_notas_txt[(array[com].com_nota_fk -1)] = num;
                            num_txt = num.toString( );
                            $("." + "span_" + ( array[com].com_nota_fk - 1 ).toString( ) + "_" + array[com].com_praia_fk.toString( ) ).each( 
                                function ( )
                                {
                                    $(this).html( num_txt );                                    
                                }
                            );																				
                        } 
                    },	
                    
                    error: function(jqXHR, textStatus, errorThrown) 
                    {
                        alert( "Erro com o ajax, por favor verifique a conectividade.")
                    }
                });			
            }
            /*--------------------------------*/
            
            /*Função para receber o call do ajax para as notificações*/
            function ajax_call_not( json, id )
            {
                $.ajax
                ({
                    type: 'POST',
                    crossDomain: true,
                    url: 'http://surfer2surfer.com.br/not_ajax.php',
                    data : json,
                    success: function( data )
                    {
                        var array = JSON.parse( data );
                        if ( array[0].usr_proc == 1 )
                        {
                            $( "#not_receb" ).hide( );
                            localStorage.setItem( "USR_PROC" , 1 );                            
                            $( "#not_para" ).show( );                            
                        }
                        else
                        {
                            $( "#not_para" ).hide( );
                            localStorage.setItem( "USR_PROC" , 0 );
                            $( "#not_receb" ).show( ); 
                        }
                        
                    },	
                    
                    error: function(jqXHR, textStatus, errorThrown) 
                    {
                        alert( "Erro com o ajax, por favor verifique a conectividade.")
                    }
                });			
            }
            /*--------------------------------*/
            
            /*Função parar retirar o ajax das notificações*/
            function ajax_not_setInterval ( json_string, int_id )
            {
                if( ajax_array_not[int_id] == null )
                {
                    var ajax_interval = setInterval ( function ( ) { ajax_call_not ( json_string, int_id.toString( ) ) }, 5000 );
                    ajax_array_not[int_id] = ajax_interval;
                    ajax_all.push( ajax_interval );
                }
            }
            
            /*Função parar por o ajax dos spans favoritos*/
            function ajax_lista_setInterval ( json_string, int_id )
            {
                if( ajax_array_lista[int_id] == null )
                {
                    var ajax_interval = setInterval ( function ( ) { ajax_call_lista ( json_string, int_id.toString( ) ) }, 5000 );
                    ajax_array_lista[int_id] = ajax_interval;
                    ajax_all.push( ajax_interval );
                }
            }
            
            /*Função para receber o call de ajax juntamente com o json que contem o id*/
            function ajax_call( json, id )
            {
                $.ajax
                ({
                    type: 'POST',
                    crossDomain: true,
                    url: 'http://surfer2surfer.com.br/json_comentarios_praia.php',
                    data : json,
                    success: function( data )
                    {	
                        var array = JSON.parse( data );
                        var maxHeight = $( window ).height() - 30 + "px";
                        
                        if( $( "#div_feed" ).children( ).length == 0 )
                        {
                            for( var com = 0 ; com < array.length; com++ )
                            {                
                                var cont = false;
                                var data_ind =  array[com].com_data.indexOf( ' ' ) + 1 ;
                                var data = array[com].com_data.substr( data_ind );
                                
                                if( array[com].usr_nome.indexOf( ' ' ) == -1 )
                                {
                                    var nome = array[com].usr_nome;
                                }
                                else
                                {
                                    var nome_completo = array[com].usr_nome; 
                                    var nome_primeiro =  nome_completo.substr( 0, nome_completo.indexOf( ' ' ) ) ;
                                    var nome_ultimo = nome_completo.substr( nome_completo.lastIndexOf( ' ' ) ) ;                                    
                                    var nome = nome_primeiro + ' ' + nome_ultimo;
                                }
                                
                                var comment = document.createElement( "div" );
                                var comment_grid = document.createElement( "div" );
                                var comment_block_a = document.createElement( "div" );
                                var comment_block_b = document.createElement( "div" );
                                var comment_block_c = document.createElement( "div" );
                                
                                var comment_img = document.createElement( "img" );
                                var comment_header_div = document.createElement( "div" );
                                var comment_content_div = document.createElement( "div" );
                                var comment_content = document.createElement( "p" ); 
                                
                                var tam_div = document.createElement( "div" );
                                var nota_div = document.createElement( "div" );
                                var data_div = document.createElement( "div" );
                                
                                var comment_usr_nome_span = document.createElement( "span" );
                                var comment_nota_span = document.createElement( "span" );
                                var comment_tam_span = document.createElement( "span" );
                                var comment_data_span = document.createElement( "span" );
                                
                                var comment_tam_span_txtnode = document.createTextNode( array[com].tam_onda + " M");
                                var comment_nota_span_txtnode = document.createTextNode( array[com].nota_texto );
                                var comment_usr_nome_span_txtnode = document.createTextNode( nome );
                                var comment_content_txtnode = document.createTextNode( array[com].com_conteudo );
                                var comment_data_txtnode = document.createTextNode( data );
                                
                                var comment_table = document.createElement( "table" );
                                var comment_table_tbody = document.createElement( "tbody" );
                                var comment_table_img_tr = document.createElement( "tr" );
                                var comment_table_nome_tr = document.createElement( "tr" );
                                var comment_table_img_td = document.createElement( "td" );
                                var comment_table_nome_td = document.createElement( "td" );
                                
                                comment_table.appendChild( comment_table_tbody );
                                comment_table_tbody.appendChild( comment_table_img_tr );
                                comment_table_tbody.appendChild( comment_table_nome_tr );
                                comment_table_img_tr.appendChild( comment_table_img_td );
                                comment_table_nome_tr.appendChild( comment_table_nome_td );
                                
                                comment_table_nome_td.appendChild( comment_usr_nome_span );
                                comment_table_img_td.appendChild( comment_img );
                                
                                comment_header_div.appendChild( comment_table );                                
                                
                                
                                comment.setAttribute( "id", array[com].com_id );
                                comment_grid.setAttribute( "class", "ui-grid-a comment_grid" );
                                comment_block_a.setAttribute( "class", "ui-block-a" );
                                comment_block_b.setAttribute( "class", "ui-block-b" );
                                comment_block_b.setAttribute( "id", "block_b_" + array[com].com_id );
                                comment_grid.appendChild( comment_block_a );
                                comment_grid.appendChild( comment_block_b );
                                
                                
                                comment_block_a.appendChild( comment_header_div );
                                comment_block_a.appendChild( comment_content_div );
                                comment_header_div.setAttribute( "class", "ui-bar ui-bar-a comment_h_div");
                                comment_content_div.setAttribute( "class", "ui-body ui-body-a comment_p_div wordwrap");
                                comment_img.setAttribute( "src", array[com].usr_foto );
                                comment_img.setAttribute( "class", "comment_img" );
                                comment_img.setAttribute( "border", 0 );
                                
                                comment_usr_nome_span.appendChild( comment_usr_nome_span_txtnode );
                                comment_usr_nome_span.setAttribute( "class", "com_nome_span" );                                                               
                                comment_content_div.appendChild( comment_content );                                
                                comment_content.appendChild( comment_content_txtnode );                                
                                comment_block_b.appendChild( tam_div );
                                comment_block_b.appendChild( nota_div );
                                comment_block_b.appendChild( data_div );
                                tam_div.setAttribute( "class", "ui-body ui-body-a span_div_com");
                                tam_div.appendChild( comment_tam_span );
                                comment_tam_span.appendChild( comment_tam_span_txtnode );
                                nota_div.setAttribute( "class", "ui-body ui-body-a span_div_com");
                                nota_div.appendChild( comment_nota_span );
                                comment_nota_span.appendChild( comment_nota_span_txtnode ); 
                                data_div.setAttribute( "class", "ui-body ui-body-a span_div_com");
                                data_div.appendChild( comment_data_span ); 
                                comment_data_span.appendChild( comment_data_txtnode );
                                
                                comment_nota_span.style.color = array[com].nota_cor ;
                                comment_tam_span.setAttribute( "class", "span_com");
                                comment_nota_span.setAttribute( "class", "span_com");
                                comment_data_span.setAttribute( "class", "span_com");
                                
                                comment.appendChild( comment_grid ); 
                                
                                if( array[com].com_foto_url != null )
                                {
                                    
                                    var comment_photo_div = document.createElement( "div" );
                                    var comment_photo_but = document.createElement( "a" );
                                    var comment_div_pop = document.createElement( "div" );
                                    var comment_photo_back = document.createElement( "a" );
                                    var comment_photo = document.createElement( "img" );
                                    var comment_photo_min = document.createElement( "img" );
                                    var comment_photo_txt = document.createTextNode( "Foto" );
                                    
                                    comment_photo_but.setAttribute( "href", "#com_" + array[com].com_id );
                                    comment_photo_div.setAttribute( "id", "comdiv_" + array[com].com_id );
                                    comment_photo_but.setAttribute( "data-rel", "popup" );
                                    comment_photo_but.setAttribute( "data-position-to", "window" );                                    
                                    comment_div_pop.setAttribute( "data-role", "popup" );
                                    comment_div_pop.setAttribute( "data-tolerance", "30,15" );
                                    comment_div_pop.setAttribute( "data-corners", "false" );
                                    comment_div_pop.setAttribute( "data-overlay-theme", "a" );
                                    comment_div_pop.setAttribute( "id", "com_" + array[com].com_id );
                                    comment_div_pop.setAttribute( "class", "photopopup" );
                                    comment_photo_back.setAttribute( "href", "#" );
                                    comment_photo_back.setAttribute( "data-rel", "back" );
                                    comment_photo_back.setAttribute( "class", "ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right" );
                                    comment_photo.setAttribute( "src", array[com].com_foto_url );
                                    comment_photo.setAttribute( "class", "popphoto" ); 
                                    comment_photo.setAttribute( "style", "max-height:" + maxHeight + ";" );
                                    comment_photo_min.setAttribute( "class", "popphoto" );
                                    comment_photo_min.setAttribute( "src", array[com].com_foto_url );
                                    comment_photo_min.setAttribute( "style", "height:245px; width:115px;" );                                    
                                    
                                    
                                    comment_photo_but.appendChild( comment_photo_min );
                                    comment_div_pop.appendChild( comment_photo_back );
                                    comment_div_pop.appendChild( comment_photo );
                                    
                                    comment_photo_div.appendChild( comment_photo_but );
                                    comment_photo_div.appendChild( comment_div_pop );
                                    
                                    comment_block_b.appendChild( comment_photo_div );                                    
                                }
                                
                                else
                                {
                                    var comment_photo_div = document.createElement( "div" );
                                    var comment_photo_but = document.createElement( "a" );
                                    var comment_div_pop = document.createElement( "div" );
                                    var comment_photo_back = document.createElement( "a" );
                                    var comment_photo = document.createElement( "img" );
                                    var comment_photo_min = document.createElement( "img" );
                                    var comment_photo_txt = document.createTextNode( "Foto" );
                                    
                                    comment_photo_but.setAttribute( "href", "#com_" + array[com].com_id );
                                    comment_photo_div.setAttribute( "id", "comdiv_" + array[com].com_id );
                                    comment_photo_but.setAttribute( "data-rel", "popup" );
                                    comment_photo_but.setAttribute( "data-position-to", "window" );                                    
                                    comment_div_pop.setAttribute( "data-role", "popup" );
                                    comment_div_pop.setAttribute( "data-tolerance", "30,15" );
                                    comment_div_pop.setAttribute( "data-corners", "false" );
                                    comment_div_pop.setAttribute( "data-overlay-theme", "a" );
                                    comment_div_pop.setAttribute( "id", "com_" + array[com].com_id );
                                    comment_div_pop.setAttribute( "class", "photopopup" );
                                    comment_photo_back.setAttribute( "href", "#" );
                                    comment_photo_back.setAttribute( "data-rel", "back" );
                                    comment_photo_back.setAttribute( "class", "ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right" );
                                    comment_photo.setAttribute( "src", "indis.jpg" );
                                    comment_photo.setAttribute( "class", "popphoto indis" ); 
                                    comment_photo.setAttribute( "style", "max-height:" + maxHeight + ";" );
                                    comment_photo_min.setAttribute( "class", "popphoto" );
                                    comment_photo_min.setAttribute( "src", "indis.jpg" );
                                    comment_photo_min.setAttribute( "style", "height:245px; width:115px;" );                                    
                                    
                                    
                                    comment_photo_but.appendChild( comment_photo_min );
                                    comment_div_pop.appendChild( comment_photo_back );
                                    comment_div_pop.appendChild( comment_photo );
                                    
                                    comment_photo_div.appendChild( comment_photo_but );
                                    comment_photo_div.appendChild( comment_div_pop );
                                    
                                    comment_block_b.appendChild( comment_photo_div );                                    
                                }
                                
                                document.getElementById( "div_feed" ).insertBefore( comment , document.getElementById( "div_feed" ).firstChild );   
                                $( "#div_feed" ).trigger('create');
                            }  
                        }
                        
                        else
                        {
                            for( var com = 0 ; com < array.length; com++ )
                            {
                                var cont = false;
                                $( "#div_feed" ).children( ).each( 
                                    function ( )
                                    {                                    
                                        if( array[com].com_id == $( this ).attr( "id" ) )
                                        {
                                            if(  array[com].com_foto_url != null )
                                            {                                              
                                                if( $( "#praia_profile" ).find( "#" + "com_" + array[com].com_id ).length == 0 )
                                                {                                                    
                                                    var comment_photo_div = document.createElement( "div" );
                                                    var comment_photo_but = document.createElement( "a" );
                                                    var comment_div_pop = document.createElement( "div" );
                                                    var comment_photo_back = document.createElement( "a" );
                                                    var comment_photo = document.createElement( "img" );
                                                    var comment_photo_min = document.createElement( "img" );
                                                    var comment_photo_txt = document.createTextNode( "Foto" );
                                                    
                                                    comment_photo_but.setAttribute( "href", "#com_" + array[com].com_id );
                                                    comment_photo_div.setAttribute( "id", "comdiv_" + array[com].com_id );
                                                    comment_photo_but.setAttribute( "data-rel", "popup" );
                                                    comment_photo_but.setAttribute( "data-position-to", "window" );                                    
                                                    comment_div_pop.setAttribute( "data-role", "popup" );
                                                    comment_div_pop.setAttribute( "data-tolerance", "30,15" );
                                                    comment_div_pop.setAttribute( "data-corners", "false" );
                                                    comment_div_pop.setAttribute( "data-overlay-theme", "a" );
                                                    comment_div_pop.setAttribute( "id", "com_" + array[com].com_id );
                                                    comment_div_pop.setAttribute( "class", "photopopup" );
                                                    comment_photo_back.setAttribute( "href", "#" );
                                                    comment_photo_back.setAttribute( "data-rel", "back" );
                                                    comment_photo_back.setAttribute( "class", "ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right" );
                                                    comment_photo.setAttribute( "src", array[com].com_foto_url );
                                                    comment_photo.setAttribute( "class", "popphoto" ); 
                                                    comment_photo.setAttribute( "style", "max-height:" + maxHeight + ";" );
                                                    comment_photo_min.setAttribute( "class", "popphoto indis" );
                                                    comment_photo_min.setAttribute( "src", array[com].com_foto_url );
                                                    comment_photo_min.setAttribute( "style", "height:245px; width:115px;" );                                    
                                                    
                                                    
                                                    comment_photo_but.appendChild( comment_photo_min );
                                                    comment_div_pop.appendChild( comment_photo_back );
                                                    comment_div_pop.appendChild( comment_photo );
                                                    
                                                    comment_photo_div.appendChild( comment_photo_but );
                                                    comment_photo_div.appendChild( comment_div_pop );
                                                    
                                                    document.getElementById( "block_b_" + array[com].com_id ).appendChild( comment_photo_div );
                                                    $( "#block_b_" + array[com].com_id ).trigger('create');
                                                }
                                                else if( $( "#" + "com_" + array[com].com_id ).find( ".indis" ).length > 0 )
                                                {
                                                    var com_div = document.getElementById( "comdiv_" + array[com].com_id );
                                                    while ( com_div.firstChild ) 
                                                    {
                                                        com_div.removeChild( com_div.firstChild );
                                                    }
                                                    
                                                    var comment_photo_div = document.createElement( "div" );
                                                    var comment_photo_but = document.createElement( "a" );
                                                    var comment_div_pop = document.createElement( "div" );
                                                    var comment_photo_back = document.createElement( "a" );
                                                    var comment_photo = document.createElement( "img" );
                                                    var comment_photo_min = document.createElement( "img" );
                                                    var comment_photo_txt = document.createTextNode( "Foto" );
                                                    
                                                    comment_photo_but.setAttribute( "href", "#com_" + array[com].com_id );
                                                    comment_photo_div.setAttribute( "id", "comdiv_" + array[com].com_id );
                                                    comment_photo_but.setAttribute( "data-rel", "popup" );
                                                    comment_photo_but.setAttribute( "data-position-to", "window" );                                    
                                                    comment_div_pop.setAttribute( "data-role", "popup" );
                                                    comment_div_pop.setAttribute( "data-tolerance", "30,15" );
                                                    comment_div_pop.setAttribute( "data-corners", "false" );
                                                    comment_div_pop.setAttribute( "data-overlay-theme", "a" );
                                                    comment_div_pop.setAttribute( "id", "com_" + array[com].com_id );
                                                    comment_div_pop.setAttribute( "class", "photopopup" );
                                                    comment_photo_back.setAttribute( "href", "#" );
                                                    comment_photo_back.setAttribute( "data-rel", "back" );
                                                    comment_photo_back.setAttribute( "class", "ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right" );
                                                    comment_photo.setAttribute( "src", array[com].com_foto_url );
                                                    comment_photo.setAttribute( "class", "popphoto" ); 
                                                    comment_photo.setAttribute( "style", "max-height:" + maxHeight + ";" );
                                                    comment_photo_min.setAttribute( "class", "popphoto indis" );
                                                    comment_photo_min.setAttribute( "src", array[com].com_foto_url );
                                                    comment_photo_min.setAttribute( "style", "height:245px; width:115px;" );                                    
                                                    
                                                    
                                                    comment_photo_but.appendChild( comment_photo_min );
                                                    comment_div_pop.appendChild( comment_photo_back );
                                                    comment_div_pop.appendChild( comment_photo );
                                                    
                                                    comment_photo_div.appendChild( comment_photo_but );
                                                    comment_photo_div.appendChild( comment_div_pop );
                                                    
                                                    document.getElementById( "block_b_" + array[com].com_id ).appendChild( comment_photo_div );
                                                    $( "#block_b_" + array[com].com_id ).trigger('create');
                                                }
                                                
                                                
                                            }
                                            
                                            else
                                            {
                                                if( $( "#praia_profile" ).find( "#" + "com_" + array[com].com_id ).length == 0 )
                                                {
                                                    var comment_photo_div = document.createElement( "div" );
                                                    var comment_photo_but = document.createElement( "a" );
                                                    var comment_div_pop = document.createElement( "div" );
                                                    var comment_photo_back = document.createElement( "a" );
                                                    var comment_photo = document.createElement( "img" );
                                                    var comment_photo_min = document.createElement( "img" );
                                                    var comment_photo_txt = document.createTextNode( "Foto" );
                                                    
                                                    comment_photo_but.setAttribute( "href", "#com_" + array[com].com_id );
                                                    comment_photo_div.setAttribute( "id", "comdiv_" + array[com].com_id );
                                                    comment_photo_but.setAttribute( "data-rel", "popup" );
                                                    comment_photo_but.setAttribute( "data-position-to", "window" );                                    
                                                    comment_div_pop.setAttribute( "data-role", "popup" );
                                                    comment_div_pop.setAttribute( "data-tolerance", "30,15" );
                                                    comment_div_pop.setAttribute( "data-corners", "false" );
                                                    comment_div_pop.setAttribute( "data-overlay-theme", "a" );
                                                    comment_div_pop.setAttribute( "id", "com_" + array[com].com_id );
                                                    comment_div_pop.setAttribute( "class", "photopopup indis" );
                                                    comment_photo_back.setAttribute( "href", "#" );
                                                    comment_photo_back.setAttribute( "data-rel", "back" );
                                                    comment_photo_back.setAttribute( "class", "ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right" );
                                                    comment_photo.setAttribute( "src", "indis.jpg" );
                                                    comment_photo.setAttribute( "class", "popphoto indis" ); 
                                                    comment_photo.setAttribute( "style", "max-height:" + maxHeight + ";" );
                                                    comment_photo_min.setAttribute( "class", "popphoto" );
                                                    comment_photo_min.setAttribute( "src", "indis.jpg" );
                                                    comment_photo_min.setAttribute( "style", "height:245px; width:115px;" );                                    
                                                    
                                                    
                                                    comment_photo_but.appendChild( comment_photo_min );
                                                    comment_div_pop.appendChild( comment_photo_back );
                                                    comment_div_pop.appendChild( comment_photo );
                                                    
                                                    comment_photo_div.appendChild( comment_photo_but );
                                                    comment_photo_div.appendChild( comment_div_pop );
                                                    
                                                    document.getElementById( "block_b_" + array[com].com_id ).appendChild( comment_photo_div );
                                                    
                                                    $( "#div_feed" ).trigger('create');
                                                }
                                            }
                                            cont = true;
                                            return;
                                        } 
                                    }
                                );
                                if ( cont == true )
                                {
                                    cont = false;                                                                  
                                    continue;
                                }
                                
                                var data_ind =  array[com].com_data.indexOf( ' ' ) + 1 ;
                                var data = array[com].com_data.substr( data_ind );
                                
                                if( array[com].usr_nome.indexOf( ' ' ) == -1 )
                                {
                                    var nome = array[com].usr_nome;
                                }
                                else
                                {
                                    var nome_completo = array[com].usr_nome; 
                                    var nome_primeiro =  nome_completo.substr( 0, nome_completo.indexOf( ' ' ) ) ;
                                    var nome_ultimo = nome_completo.substr( nome_completo.lastIndexOf( ' ' ) ) ;                                    
                                    var nome = nome_primeiro + ' ' + nome_ultimo;
                                }
                                
                                var comment = document.createElement( "div" );
                                var comment_grid = document.createElement( "div" );
                                var comment_block_a = document.createElement( "div" );
                                var comment_block_b = document.createElement( "div" );
                                var comment_block_c = document.createElement( "div" );
                                
                                var comment_img = document.createElement( "img" );
                                var comment_header_div = document.createElement( "div" );
                                var comment_content_div = document.createElement( "div" );
                                var comment_content = document.createElement( "p" );
                                
                                var tam_div = document.createElement( "div" );
                                var nota_div = document.createElement( "div" );
                                var data_div = document.createElement( "div" );
                                
                                var comment_usr_nome_span = document.createElement( "span" );
                                var comment_nota_span = document.createElement( "span" );
                                var comment_tam_span = document.createElement( "span" );
                                var comment_data_span = document.createElement( "span" );
                                
                                var comment_tam_span_txtnode = document.createTextNode( array[com].tam_onda + " M");
                                var comment_nota_span_txtnode = document.createTextNode( array[com].nota_texto );
                                var comment_usr_nome_span_txtnode = document.createTextNode( nome );
                                var comment_content_txtnode = document.createTextNode( array[com].com_conteudo );
                                var comment_data_txtnode = document.createTextNode( data );
                                
                                var comment_table = document.createElement( "table" );
                                var comment_table_tbody = document.createElement( "tbody" );
                                var comment_table_img_tr = document.createElement( "tr" );
                                var comment_table_nome_tr = document.createElement( "tr" );
                                var comment_table_img_td = document.createElement( "td" );
                                var comment_table_nome_td = document.createElement( "td" );
                                
                                comment_table.appendChild( comment_table_tbody );
                                comment_table_tbody.appendChild( comment_table_img_tr );
                                comment_table_tbody.appendChild( comment_table_nome_tr );
                                comment_table_img_tr.appendChild( comment_table_img_td );
                                comment_table_nome_tr.appendChild( comment_table_nome_td );
                                
                                comment_table_nome_td.appendChild( comment_usr_nome_span );
                                comment_table_img_td.appendChild( comment_img );
                                
                                comment_header_div.appendChild( comment_table ); 
                                
                                comment.setAttribute( "id", array[com].com_id );
                                comment_grid.setAttribute( "class", "ui-grid-a comment_grid" );
                                comment_block_a.setAttribute( "class", "ui-block-a" );
                                comment_block_b.setAttribute( "class", "ui-block-b" );
                                comment_block_b.setAttribute( "id", "block_b_" + array[com].com_id );
                                comment_grid.appendChild( comment_block_a );
                                comment_grid.appendChild( comment_block_b );                                
                                
                                comment_block_a.appendChild( comment_header_div );
                                comment_block_a.appendChild( comment_content_div );
                                comment_header_div.setAttribute( "class", "ui-bar ui-bar-a comment_h_div");
                                comment_content_div.setAttribute( "class", "ui-body ui-body-a comment_p_div wordwrap");
                                comment_img.setAttribute( "src", array[com].usr_foto );
                                comment_img.setAttribute( "class", "comment_img" );
                                comment_img.setAttribute( "border", 0 );                               
                                comment_usr_nome_span.appendChild( comment_usr_nome_span_txtnode );
                                comment_usr_nome_span.setAttribute( "class", "com_nome_span" );                                
                                comment_content_div.appendChild( comment_content );                                
                                comment_content.appendChild( comment_content_txtnode );
                                
                                comment_block_b.appendChild( tam_div );
                                comment_block_b.appendChild( nota_div );
                                comment_block_b.appendChild( data_div );
                                tam_div.setAttribute( "class", "ui-body ui-body-a span_div_com");
                                tam_div.appendChild( comment_tam_span );
                                comment_tam_span.appendChild( comment_tam_span_txtnode );
                                nota_div.setAttribute( "class", "ui-body ui-body-a span_div_com");
                                nota_div.appendChild( comment_nota_span );
                                comment_nota_span.appendChild( comment_nota_span_txtnode ); 
                                data_div.setAttribute( "class", "ui-body ui-body-a span_div_com");
                                data_div.appendChild( comment_data_span ); 
                                comment_data_span.appendChild( comment_data_txtnode );
                                
                                comment_nota_span.style.color = array[com].nota_cor ;
                                comment_tam_span.setAttribute( "class", "span_com");
                                comment_nota_span.setAttribute( "class", "span_com");
                                comment_data_span.setAttribute( "class", "span_com");                               
                                
                                
                                comment.appendChild( comment_grid );
                                
                                document.getElementById( "div_feed" ).insertBefore( comment , document.getElementById( "div_feed" ).firstChild );
                                $( "#div_feed" ).trigger('create');
                                
                            }
                        }  
                        
                    },	
                    
                    error: function(jqXHR, textStatus, errorThrown) 
                    {
                        alert( "Erro com o ajax, por favor verifique a conectividade.")
                    }
                });			
            }
            /*--------------------------------*/
            
            /*Função para receber o call de ajax juntamente com o json que contem o id*/
            function ajax_call_fav( json, id )
            {
                $.ajax
                ({
                    type: 'POST',
                    crossDomain: true,
                    url: 'http://surfer2surfer.com.br/json_comment_fav_handler.php',
                    data : json,
                    success: function( data )
                    {	
                        var array = JSON.parse( data );
                        var maxHeight = $( window ).height() - 30 + "px";                        
                        if( document.getElementById( "cidade_ul_fav_" + array[0].cidade_id ) == null )
                        {
                            var cidade_ul = document.createElement( "ul" );               
                            cidade_ul.setAttribute( "data-role", "listview" );
                            cidade_ul.setAttribute( "data-divider-theme", "a" );
                            cidade_ul.setAttribute( "data-inset", "true" );
                            cidade_ul.setAttribute( "id", "cidade_ul_fav_" + array[0].cidade_id );  
                            
                            var cidade_li = document.createElement( "li" );
                            var cidade_txt = document.createTextNode( array[0].cidade_nome );
                            cidade_li.setAttribute( "data-role", "list-divider" );
                            cidade_li.setAttribute( "id", "cidade_li_" + array[0].cidade_id );                                         
                            cidade_li.className = "cidade_li";
                            cidade_li.appendChild( cidade_txt ); 
                            cidade_ul.appendChild( cidade_li );
                            document.getElementById( "div_feed_fav" ).appendChild( cidade_ul );
                            $( "#div_feed_fav" ).trigger('create');
                        }
                        
                        if( document.getElementById( "praia_li_" + id ) == null )
                        {                                
                            var comment_praia_li = document.createElement( "li" );
                            var comment_li_fav_txtnode = document.createTextNode ( array[0].praia_nome );
                            
                            comment_praia_li.appendChild( comment_li_fav_txtnode );
                            comment_praia_li.setAttribute( "data-role", "list-divider" ); 
                            comment_praia_li.setAttribute( "id", "praia_li_" + id  ); 
                            comment_praia_li.setAttribute( "class", "cidade_li ui-li-divider ui-bar-a ui-corner-all"  ); 
                            document.getElementById( "cidade_ul_fav_" + array[0].cidade_id ).appendChild( comment_praia_li );                            
                            
                        }                        
                        for( var com = 0 ; com < array.length; com++ )
                        {
                            var cont = false;                                
                            $( "#cidade_ul_fav_" + array[com].cidade_id ).children( "li" ).each( 
                                function ( )
                                {
                                    if( "fav_" + array[com].com_id == $( this ).attr( "id" ) )
                                    {
                                        if(  array[com].com_foto_url != null )
                                        { 
                                            if( $( "#user_panel" ).find( "#" + "comfav_" + array[com].com_id ).length == 0 )
                                            {
                                                var comment_photo_div = document.createElement( "div" );
                                                var comment_photo_but = document.createElement( "a" );
                                                var comment_div_pop = document.createElement( "div" );
                                                var comment_photo_back = document.createElement( "a" );
                                                var comment_photo = document.createElement( "img" );
                                                var comment_photo_min = document.createElement( "img" );                                           
                                                
                                                comment_photo_but.setAttribute( "href", "#comfav_" + array[com].com_id );
                                                comment_photo_div.setAttribute( "id", "comfavdiv_" + array[com].com_id );
                                                comment_photo_but.setAttribute( "data-rel", "popup" );
                                                comment_photo_but.setAttribute( "data-position-to", "window" );                                    
                                                comment_div_pop.setAttribute( "data-role", "popup" );
                                                comment_div_pop.setAttribute( "data-tolerance", "30,15" );
                                                comment_div_pop.setAttribute( "data-corners", "false" );
                                                comment_div_pop.setAttribute( "data-overlay-theme", "a" );
                                                comment_div_pop.setAttribute( "id", "comfav_" + array[com].com_id );
                                                comment_div_pop.setAttribute( "class", "photopopup" );
                                                comment_photo_back.setAttribute( "href", "#" );
                                                comment_photo_back.setAttribute( "data-rel", "back" );
                                                comment_photo_back.setAttribute( "class", "ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right" );
                                                comment_photo.setAttribute( "src", array[com].com_foto_url );
                                                comment_photo.setAttribute( "class", "popphoto" ); 
                                                comment_photo.setAttribute( "style", "max-height:" + maxHeight + ";" );
                                                comment_photo_min.setAttribute( "class", "popphoto indis" );
                                                comment_photo_min.setAttribute( "src", array[com].com_foto_url );
                                                comment_photo_min.setAttribute( "style", "height:245px; width:115px;" );                                    
                                                
                                                
                                                comment_photo_but.appendChild( comment_photo_min );
                                                comment_div_pop.appendChild( comment_photo_back );
                                                comment_div_pop.appendChild( comment_photo );
                                                
                                                comment_photo_div.appendChild( comment_photo_but );
                                                comment_photo_div.appendChild( comment_div_pop );
                                                
                                                document.getElementById( "block_b_fav_" + array[com].com_id ).appendChild( comment_photo_div );
                                                $( "#block_b_fav_" + array[com].com_id ).trigger('create');
                                            }
                                            else if( $( "#" + "comfav_" + array[com].com_id ).find( ".indis" ).length > 0 )
                                            {
                                                var comfavdiv = document.getElementById( "comfavdiv_" + array[com].com_id );
                                                while ( comfavdiv.firstChild ) 
                                                {
                                                    comfavdiv.removeChild( comfavdiv.firstChild );
                                                }
                                                
                                                var comment_photo_div = document.createElement( "div" );
                                                var comment_photo_but = document.createElement( "a" );
                                                var comment_div_pop = document.createElement( "div" );
                                                var comment_photo_back = document.createElement( "a" );
                                                var comment_photo = document.createElement( "img" );
                                                var comment_photo_min = document.createElement( "img" );
                                                var comment_photo_txt = document.createTextNode( "Foto" );
                                                
                                                comment_photo_but.setAttribute( "href", "#comfav_" + array[com].com_id );
                                                comment_photo_div.setAttribute( "id", "comfavdiv_" + array[com].com_id );
                                                comment_photo_but.setAttribute( "data-rel", "popup" );
                                                comment_photo_but.setAttribute( "data-position-to", "window" );                                    
                                                comment_div_pop.setAttribute( "data-role", "popup" );
                                                comment_div_pop.setAttribute( "data-tolerance", "30,15" );
                                                comment_div_pop.setAttribute( "data-corners", "false" );
                                                comment_div_pop.setAttribute( "data-overlay-theme", "a" );
                                                comment_div_pop.setAttribute( "id", "comfav_" + array[com].com_id );
                                                comment_div_pop.setAttribute( "class", "photopopup" );
                                                comment_photo_back.setAttribute( "href", "#" );
                                                comment_photo_back.setAttribute( "data-rel", "back" );
                                                comment_photo_back.setAttribute( "class", "ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right" );
                                                comment_photo.setAttribute( "src", array[com].com_foto_url );
                                                comment_photo.setAttribute( "class", "popphoto" ); 
                                                comment_photo.setAttribute( "style", "max-height:" + maxHeight + ";" );
                                                comment_photo_min.setAttribute( "class", "popphoto indis" );
                                                comment_photo_min.setAttribute( "src", array[com].com_foto_url );
                                                comment_photo_min.setAttribute( "style", "height:245px; width:115px;" );                                    
                                                
                                                
                                                comment_photo_but.appendChild( comment_photo_min );
                                                comment_div_pop.appendChild( comment_photo_back );
                                                comment_div_pop.appendChild( comment_photo );
                                                
                                                comment_photo_div.appendChild( comment_photo_but );
                                                comment_photo_div.appendChild( comment_div_pop );
                                                
                                                document.getElementById( "block_b_fav_" + array[com].com_id ).appendChild( comment_photo_div );
                                                $( "#block_b_fav_" + array[com].com_id ).trigger('create');
                                            }
                                            
                                            
                                        }
                                        
                                        else
                                        {
                                            if( $( "#user_panel" ).find( "#" + "comfav_" + array[com].com_id ).length == 0 )
                                            {
                                                var comment_photo_div = document.createElement( "div" );
                                                var comment_photo_but = document.createElement( "a" );
                                                var comment_div_pop = document.createElement( "div" );
                                                var comment_photo_back = document.createElement( "a" );
                                                var comment_photo = document.createElement( "img" );
                                                var comment_photo_min = document.createElement( "img" );
                                                var comment_photo_txt = document.createTextNode( "Foto" );
                                                
                                                comment_photo_but.setAttribute( "href", "#comfav_" + array[com].com_id );
                                                comment_photo_div.setAttribute( "id", "comfavdiv_" + array[com].com_id );
                                                comment_photo_but.setAttribute( "data-rel", "popup" );
                                                comment_photo_but.setAttribute( "data-position-to", "window" );                                    
                                                comment_div_pop.setAttribute( "data-role", "popup" );
                                                comment_div_pop.setAttribute( "data-tolerance", "30,15" );
                                                comment_div_pop.setAttribute( "data-corners", "false" );
                                                comment_div_pop.setAttribute( "data-overlay-theme", "a" );
                                                comment_div_pop.setAttribute( "id", "comfav_" + array[com].com_id );
                                                comment_div_pop.setAttribute( "class", "photopopup indis" );
                                                comment_photo_back.setAttribute( "href", "#" );
                                                comment_photo_back.setAttribute( "data-rel", "back" );
                                                comment_photo_back.setAttribute( "class", "ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right" );
                                                comment_photo.setAttribute( "src", "indis.jpg" );
                                                comment_photo.setAttribute( "class", "popphoto indis" ); 
                                                comment_photo.setAttribute( "style", "max-height:" + maxHeight + ";" );
                                                comment_photo_min.setAttribute( "class", "popphoto" );
                                                comment_photo_min.setAttribute( "src", "indis.jpg" );
                                                comment_photo_min.setAttribute( "style", "height:245px; width:115px;" );                                    
                                                
                                                
                                                comment_photo_but.appendChild( comment_photo_min );
                                                comment_div_pop.appendChild( comment_photo_back );
                                                comment_div_pop.appendChild( comment_photo );
                                                
                                                comment_photo_div.appendChild( comment_photo_but );
                                                comment_photo_div.appendChild( comment_div_pop );
                                                
                                                document.getElementById( "block_b_fav_" + array[com].com_id ).appendChild( comment_photo_div );
                                                
                                                $( "#block_b_fav_" + array[com].com_id ).trigger('create');
                                            }
                                        } 
                                        cont = true;
                                        return;
                                        
                                    }
                                });
                            if ( cont == true )
                            {
                                cont = false;                                                                  
                                continue;
                            }
                            
                            var data_ind =  array[com].com_data.indexOf( ' ' ) + 1 ;
                            var data = array[com].com_data.substr( data_ind );
                            if( array[com].usr_nome.indexOf( ' ' ) == -1 )
                            {
                                var nome = array[com].usr_nome;
                            }
                            else
                            {
                                var nome_completo = array[com].usr_nome; 
                                var nome_primeiro =  nome_completo.substr( 0, nome_completo.indexOf( ' ' ) ) ;
                                var nome_ultimo = nome_completo.substr( nome_completo.lastIndexOf( ' ' ) ) ;                                    
                                var nome = nome_primeiro + ' ' + nome_ultimo;
                            }
                            
                            var comment = document.createElement( "div" );
                            var comment_li = document.createElement( "li" );
                            var comment_grid = document.createElement( "div" );
                            var comment_block_a = document.createElement( "div" );
                            var comment_block_b = document.createElement( "div" );
                            var comment_block_c = document.createElement( "div" );
                            
                            
                            var comment_img = document.createElement( "img" );
                            var comment_header_div = document.createElement( "div" );
                            var comment_content_div = document.createElement( "div" );
                            var comment_content = document.createElement( "p" );
                            
                            var tam_div = document.createElement( "div" );
                            var nota_div = document.createElement( "div" );
                            var data_div = document.createElement( "div" );
                            
                            var comment_usr_nome_span = document.createElement( "span" );                            
                            var comment_nota_span = document.createElement( "span" );
                            var comment_tam_span = document.createElement( "span" );
                            var comment_data_span = document.createElement( "span" );
                            
                            var comment_tam_span_txtnode = document.createTextNode( array[com].tam_onda + " M");
                            var comment_nota_span_txtnode = document.createTextNode( array[com].nota_texto );
                            var comment_usr_nome_span_txtnode = document.createTextNode( nome );
                            var comment_content_txtnode = document.createTextNode( array[com].com_conteudo );
                            var comment_data_txtnode = document.createTextNode( data ); 
                            
                            var comment_table = document.createElement( "table" );
                            var comment_table_tbody = document.createElement( "tbody" );
                            var comment_table_img_tr = document.createElement( "tr" );
                            var comment_table_nome_tr = document.createElement( "tr" );
                            var comment_table_img_td = document.createElement( "td" );
                            var comment_table_nome_td = document.createElement( "td" );
                            
                            comment_table.appendChild( comment_table_tbody );
                            comment_table_tbody.appendChild( comment_table_img_tr );
                            comment_table_tbody.appendChild( comment_table_nome_tr );
                            comment_table_img_tr.appendChild( comment_table_img_td );
                            comment_table_nome_tr.appendChild( comment_table_nome_td );
                            
                            comment_table_nome_td.appendChild( comment_usr_nome_span );
                            comment_table_img_td.appendChild( comment_img );
                            
                            comment_header_div.appendChild( comment_table ); 
                            
                            comment_li.setAttribute( "id","fav_" +  array[com].com_id );                        		  
                            comment_grid.setAttribute( "class", "ui-grid-a comment_grid" );
                            comment_block_a.setAttribute( "class", "ui-block-a" );
                            comment_block_b.setAttribute( "class", "ui-block-b" );
                            comment_block_b.setAttribute( "id", "block_b_fav_" + array[com].com_id );
                            comment_grid.appendChild( comment_block_a );
                            comment_grid.appendChild( comment_block_b );
                            
                            
                            comment_block_a.appendChild( comment_header_div );
                            comment_block_a.appendChild( comment_content_div );
                            comment_header_div.setAttribute( "class", "ui-bar ui-bar-a comment_h_div");
                            comment_content_div.setAttribute( "class", "ui-body ui-body-a comment_p_div wordwrap");                        
                            comment_img.setAttribute( "src", array[com].usr_foto );
                            comment_img.setAttribute( "class", "comment_img" );
                            comment_img.setAttribute( "border", 0 );                           
                            comment_usr_nome_span.appendChild( comment_usr_nome_span_txtnode );
                            comment_usr_nome_span.setAttribute( "class", "com_nome_span wordwrap" );                                
                            comment_content_div.appendChild( comment_content );
                            comment_content.appendChild( comment_content_txtnode );                            
                            
                            comment_block_b.appendChild( tam_div );
                            comment_block_b.appendChild( nota_div );
                            comment_block_b.appendChild( data_div );
                            tam_div.setAttribute( "class", "ui-body ui-body-a span_div_com");
                            tam_div.appendChild( comment_tam_span );
                            comment_tam_span.appendChild( comment_tam_span_txtnode );
                            nota_div.setAttribute( "class", "ui-body ui-body-a span_div_com");
                            nota_div.appendChild( comment_nota_span );
                            comment_nota_span.appendChild( comment_nota_span_txtnode ); 
                            data_div.setAttribute( "class", "ui-body ui-body-a span_div_com");
                            data_div.appendChild( comment_data_span ); 
                            comment_data_span.appendChild( comment_data_txtnode );
                            
                            comment_nota_span.style.color = array[com].nota_cor ;
                            comment_tam_span.setAttribute( "class", "span_com");
                            comment_nota_span.setAttribute( "class", "span_com");
                            comment_data_span.setAttribute( "class", "span_com");                               
                            
                            
                            comment.appendChild( comment_grid );
                            
                            comment_li.appendChild( comment );
                            document.getElementById( "praia_li_" + array[com].com_praia_fk ).parentNode.insertBefore( comment_li ,  document.getElementById( "praia_li_" + array[com].com_praia_fk ).nextSibling);
                            
                            $( "#div_feed_fav" ).trigger('create');
                            
                            comment_content.setAttribute( "style", "white-space: pre-wrap !important; font-size: 1em !important;");
                        }
                    },	
                    
                    error: function(jqXHR, textStatus, errorThrown) 
                    {
                        alert( "Erro com o ajax, por favor verifique a conectividade.")
                    }
                });			
            }
            /*--------------------------------*/
            
            
            /*Call para o span do profil*/
            function call_span_profile( json, id )
            {
                $.ajax
                ({
                    type: 'POST',
                    crossDomain: true,
                    url: 'http://surfer2surfer.com.br/json_comentarios_praia.php',
                    data : json,
                    success: function( data )
                    {	
                        var array = JSON.parse( data );
                        var array_notas_txt = new Array ( );                     
                        
                        for ( var cor = 0 ; cor < cores.length; cor++ )
                        {
                            array_notas_txt.push ( 0 );
                        }
                        var num_txt
                        for( var com = 0 ; com < array.length; com++ )
                        {
                            var num = array_notas_txt[ ( array[com].com_nota_fk - 1 ) ];
                            num++;
                            array_notas_txt[(array[com].com_nota_fk -1)] = num;
                            num_txt = num.toString( );
                            $("." + "span_" + ( array[com].com_nota_fk - 1 ).toString( ) + "_" + array[com].com_praia_fk.toString( ) ).each( 
                                function ( )
                                {
                                    $(this).html( num_txt );
                                    $("." + "span_" + ( array[com].com_nota_fk - 1 ).toString( ) + "_prof" ).html( num_txt );                                    
                                }
                            );																				
                        } 
                    },	
                    
                    error: function(jqXHR, textStatus, errorThrown) 
                    {
                        alert( "Erro com o ajax, por favor verifique a conectividade.")
                    }
                });			
            }
            /*--------------------------------*/		
            
            /*função para setar o interval do ajax e por no array para um futuro clearinterval*/
            function ajax_fav_setInterval ( json_string, int_id )
            {
                
                if( ajax_array_fav[int_id] == null )
                {
                    var ajax_interval = setInterval ( function ( ) { ajax_call_fav ( json_string, int_id.toString( ) ) }, 10000 );
                    ajax_array_fav[int_id] = ajax_interval;
                    ajax_all.push( ajax_interval );
                }
                
            }
            /*--------------------------------*/
            
            /*função para setar o interval do ajax e por no array para um futuro clearinterval*/
            function ajax_setInterval ( json_string, int_id )
            {
                if( ajax_array[int_id] == null )
                {
                    var ajax_interval = setInterval ( function ( ) { ajax_call ( json_string, int_id.toString( ) ) }, 10000 );
                    ajax_array[int_id] = ajax_interval;
                    ajax_all.push( ajax_interval );
                }
                
            }
            /*--------------------------------*/
            
            /*função para setar o interval do ajax e por no array para um futuro clearinterval*/
            function ajax_setInterval_span ( json_string, int_id )
            {
                if( ajax_array_span[int_id] == null )
                {
                    var ajax_interval_span = setInterval ( function ( ) { call_span_profile ( json_string, int_id.toString( ) ) }, 10000 );
                    ajax_array_span[int_id] = ajax_interval_span;
                    ajax_all.push( ajax_interval_span );
                }
                
            }
            /*--------------------------------*/
            
            /*função para dar clear no interval dentro do array*/
            function ajax_clearInterval ( int_id )
            {
                clearInterval( ajax_array[int_id] );	
            }
            /*--------------------------------*/
            
            /*função para dar clear no interval dentro do array*/
            function ajax_clearInterval_span ( int_id )
            {
                clearInterval( ajax_array_span[int_id] );	
            }
            /*--------------------------------*/
            
            /*Função para verificar e-mail */
            function verifyEmail()
            {
                var status = false;     
                var emailRegEx = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i;
                if (document.getElementById("mail_usr").value.search(emailRegEx) == -1) {
                    alert("Por favor insira um e-mail válido");
                }
                else if (document.getElementById("mail_usr").value != document.getElementById("mail_usr_conf").value) {
                    alert("Os e-mails não coincidem.");
                }
                    else {                      
                        status = true;
                    }
                return status;
            }
            /*funções e variaveis da camera */
            var pictureSource;   // picture source
            var destinationType; // sets the format of returned value 
            
            // Wait for PhoneGap to connect with the device
            //
            document.addEventListener("deviceready",onDeviceReady,false);
            
            // PhoneGap is ready to be used!
            //
            function onDeviceReady() 
            {
                pictureSource=navigator.camera.PictureSourceType;
                destinationType=navigator.camera.DestinationType;
            }
            
            
            // A button will call this function
            //
            function capturePhoto( ) 
            {
                // Take picture using device camera and retrieve image as base64-encoded string
                $("body").pagecontainer("change", "#loading");             
                navigator.camera.getPicture( uploadPhoto, onFail, { limit: 1 } );
            }
            
            function onFail( message ) 
            {
                alert("Foto não enviada.");
                $( "#comment_submit" ).removeClass( "ui-disabled" );
                $("body").pagecontainer("change", "#praia_profile");   
            }
            
            function uploadPhoto( imageURI ) 
            {
                
                var options = new FileUploadOptions();           
                options.fileKey="file";           
                options.fileName=imageURI.substr(imageURI.lastIndexOf('/')+1);            
                options.mimeType="image/jpeg"; 			
                var params = new Object();            
                params.com_id = localStorage.getItem( "COM_LAST_ID" );
                
                options.params = params;
                options.chunkedMode = false;
                
                var ft = new FileTransfer();            
                ft.upload(imageURI, "http://surfer2surfer.com.br/upload_foto.php", win, fail, options);
            }
            
            function win(r) 
            {                
                if( document.getElementById( "fb_post" ).checked )
                { 
                    var com_id =  localStorage.getItem( "COM_LAST_ID" );  
                    var json_array = 
                        [
                            { 	
                                "com_id" : com_id                              
                            }
                        ];
                    
                    var json_str = JSON.stringify( json_array );
                    alert(json_str);
                    $.ajax
                    ({
                        type: 'POST',
                        crossDomain: true,
                        url: 'http://surfer2surfer.com.br/fb_info.php',
                        data : json_str,
                        success: function( data )
                        {
                            var response = JSON.parse( data );                          
                            fbWallPost( response );                           
                        },
                        error: function(jqXHR, textStatus, errorThrown) 
                        {
                            alert( "Erro com o ajax, por favor verifique a conectividade.");
                        }
                    });
                }
                
                $( "#comment_submit" ).removeClass( "ui-disabled" );
                $("body").pagecontainer("change", "#praia_profile");   
            }
            
            function fail(error) 
            {
                alert("Um erro ocorreu com o upload da foto, verifique sua conectividade.");
                $( "#comment_submit" ).removeClass( "ui-disabled" );
                $("body").pagecontainer("change", "#praia_profile");   
            }
            
            document.addEventListener("deviceready", onDeviceReady, false);
            function onDeviceReady() 
            {
                document.addEventListener( "backbutton", 
                                          function (e) 
                                          {
                                              e.preventDefault();
                                              if ( confirm( "Por motivos de segurança você não pode voltar a página usando este botão, deseja se deslogar?" ) ) 
                                              {
                                                  logOut( );
                                              }
                                              
                                              else 
                                              {
                                                  //nada
                                              }  
                                          }, false );
            }
            
            
            function favProfile ( id )
            {           
                var json_array = 
                    [
                        { "praia_id"	: id }
                    ];
                var json_str = JSON.stringify( json_array );
                ajax_setInterval( json_str, parseInt( id ) );
                ajax_setInterval_span( json_str, parseInt( id ) );						                       
                call_span_profile( json_str, parseInt( id ) );
                ajax_call( json_str, parseInt( id ) );
                localStorage.setItem( "CUR_PRAIA", parseInt( id ) );
                dadosProfile( );
                
                $("body").pagecontainer("change", "#praia_profile");
            }
            
            /* Quando o documento der load */
            $( document ).ready(
                function( )
                {      
                    $.mobile.defaultPageTransition = 'none'; 
                    //localStorage.setItem( 'profile_notas', 1 );
                    localStorage.setItem( 'profile_com', 1 );
                    localStorage.setItem( 'TOKENS_ENSURED', 0 );                    
                    
                    $( "#feed_cont" ).hide( );
                    $( "#fav_refresh" ).hide( );
                    $( "#not_receb" ).hide( );
                    $( "#not_para" ).hide( );
                    // $( "#anon_com" ).hide( );
                    //$( "#anon_com_label" ).hide( );
                    $( "#fav_button" ).hide( );
                    
                    $( "#fav_refresh" ).click(
                        function ( )
                        {                            
                            esvaziaFav ( );
                            var json_fav = 
                                [
                                    {  
                                        "usr_id": localStorage.getItem( 'USR_ID' )                                        
                                    }
                                ];
                            
                            var json_fav_str = JSON.stringify( json_fav );
                            
                            $.ajax
                            ({
                                type: 'POST',
                                crossDomain: true,
                                url: 'http://surfer2surfer.com.br/json_lista_fav.php',
                                data : json_fav_str,
                                success: function( data )
                                {
                                    var json_response_fav = JSON.parse( data );
                                    var fav_array = new Array( );
                                    
                                    for ( var i = 0; i < json_response_fav.length; i++ )
                                    {
                                        var cont = false;
                                        
                                        fav_array[ json_response_fav[i].fav_praia ] = 1;
                                        
                                        var json_id_praia_fav = 
                                            [
                                                { "praia_id"	: json_response_fav[i].fav_praia }
                                            ];
                                        
                                        $( "#fav_praias_div" ).children( ).each( 
                                            function ( )
                                            { 
                                                if( "praia_fav_" + json_response_fav[i].fav_praia == $( this ).attr( "id" ) )
                                                {
                                                    cont = true;
                                                    return; 
                                                }
                                            }
                                        );
                                        if( cont == true )
                                        {
                                            cont = false;
                                            continue;
                                        }
                                        
                                        else
                                        {
                                            var praia_fav = document.createElement( "a" );
                                            var praia_grid_fav = document.createElement( "div" );
                                            var praia_block_fav = document.createElement( "div" );
                                            var nota_block_fav = document.createElement( "div" );
                                            var nota_button_fav = document.createElement( "a" );
                                            var praia_txt_fav = document.createTextNode( json_response_fav[i].praia_nome );									
                                            
                                            var json_id_praia_fav = 
                                                [
                                                    { "praia_id"	: json_response_fav[i].fav_praia }
                                                ];
                                            
                                            var json_id_praia_fav_str = JSON.stringify( json_id_praia_fav );
                                            ajax_lista_setInterval( json_id_praia_fav_str, parseInt( json_response_fav[i].fav_praia ) );
                                            ajax_call_lista( json_id_praia_fav_str, parseInt( json_response_fav[i].fav_praia ) );
                                            ajax_fav_setInterval( json_id_praia_fav_str, parseInt( json_response_fav[i].fav_praia ) );
                                            ajax_call_fav( json_id_praia_fav_str, parseInt( json_response_fav[i].fav_praia ) );
                                            
                                            var praia = document.createElement( "a" );                                           
                                            var praia_txt = document.createTextNode( json_response_fav[i].praia_nome );
                                            
                                            praia.appendChild( praia_txt );
                                            praia.className = "praia";					
                                            praia.setAttribute( "data-role", "button" );
                                            praia.setAttribute( "id", "praia_fav_" + json_response_fav[i].fav_praia );
                                            
                                            /* span das notas para cada praia da lista*/
                                            var span_div = document.createElement( "div" );
                                            span_div.setAttribute( "class", "span_nota" );
                                            for ( var cor = 0 ; cor < cores.length; cor++ )
                                            {
                                                var nota_span = document.createElement ( "span" );							
                                                var nota_node = document.createTextNode ( "0" );
                                                nota_span.setAttribute( "class", "span_" + cor + "_" + json_response_fav[i].fav_praia );
                                                nota_span.appendChild( nota_node );
                                                span_div.appendChild( nota_span );
                                                nota_span.style.color = cores[cor].nota_cor ;
                                                if ( cor < cores.length - 1  )
                                                {	
                                                    var nota_sep = document.createElement ( "span" );                       
                                                    var nota_sep_node = document.createTextNode ( " / " );
                                                    nota_sep.appendChild( nota_sep_node );
                                                    span_div.appendChild( nota_sep );
                                                }							
                                            }
                                            praia.appendChild( span_div );
                                            var id_full = "#praia_fav_" + json_response_fav[i].fav_praia
                                            var id_ind =  id_full.lastIndexOf( '_' ) + 1 ;
                                            var id = id_full.substr( id_ind );                                            
                                            praia.setAttribute( "onclick", "favProfile(" + id + ");" );
                                            
                                            document.getElementById( "fav_praias_div" ).appendChild( praia );
                                            
                                            $("#" + "fav_praias_div" ).trigger('create');
                                        }
                                        
                                        localStorage.setItem( "FAV_LIST", JSON.stringify( fav_array ) );
                                        
                                    }
                                    
                                    if( fav_array.length == 0 )
                                    {
                                        alert("Você não possui nenhuma praia como favorita. Favorite pelo menos uma praia antes de entrar nessa sessão.");
                                    }                                    
                                    
                                },
                                error: function(jqXHR, textStatus, errorThrown) 
                                {
                                    alert( "Erro com o ajax, por favor verifique a conectividade.")
                                }
                            }); 
                        }
                    );
                    
                    $( "#fav_button" ).click(
                        function ( )
                        {                           
                            esvaziaFav ( );
                            var json_fav = 
                                [
                                    {  
                                        "usr_id": localStorage.getItem( 'USR_ID' )                                        
                                    }
                                ];
                            
                            var json_fav_str = JSON.stringify( json_fav ); 
                            
                            $.ajax
                            ({
                                type: 'POST',
                                crossDomain: true,
                                url: 'http://surfer2surfer.com.br/json_lista_fav.php',
                                data : json_fav_str,
                                success: function( data )
                                {
                                    var json_response_fav = JSON.parse( data );
                                    var fav_array = new Array( );
                                    
                                    for ( var i = 0; i < json_response_fav.length; i++ )
                                    {
                                        var cont = false;
                                        
                                        fav_array[ json_response_fav[i].fav_praia ] = 1;
                                        
                                        var json_id_praia_fav = 
                                            [
                                                { "praia_id"	: json_response_fav[i].fav_praia }
                                            ];
                                        
                                        $( "#fav_praias_div" ).children( ).each( 
                                            function ( )
                                            { 
                                                if( "praia_fav_" + json_response_fav[i].fav_praia == $( this ).attr( "id" ) )
                                                {
                                                    cont = true;
                                                    return; 
                                                }
                                            }
                                        );
                                        if( cont == true )
                                        {
                                            cont = false;
                                            continue;
                                        }
                                        
                                        else
                                        {
                                            var praia_fav = document.createElement( "a" );
                                            var praia_grid_fav = document.createElement( "div" );
                                            var praia_block_fav = document.createElement( "div" );
                                            var nota_block_fav = document.createElement( "div" );
                                            var nota_button_fav = document.createElement( "a" );
                                            var praia_txt_fav = document.createTextNode( json_response_fav[i].praia_nome );									
                                            
                                            var json_id_praia_fav = 
                                                [
                                                    { "praia_id"	: json_response_fav[i].fav_praia }
                                                ];
                                            
                                            var json_id_praia_fav_str = JSON.stringify( json_id_praia_fav );
                                            ajax_lista_setInterval( json_id_praia_fav_str, parseInt( json_response_fav[i].fav_praia ) );
                                            ajax_call_lista( json_id_praia_fav_str, parseInt( json_response_fav[i].fav_praia ) );
                                            ajax_fav_setInterval( json_id_praia_fav_str, parseInt( json_response_fav[i].fav_praia ) );
                                            ajax_call_fav( json_id_praia_fav_str, parseInt( json_response_fav[i].fav_praia ) );
                                            
                                            var praia = document.createElement( "a" );                                           
                                            var praia_txt = document.createTextNode( json_response_fav[i].praia_nome );
                                            
                                            praia.appendChild( praia_txt );
                                            praia.className = "praia";					
                                            praia.setAttribute( "data-role", "button" );
                                            praia.setAttribute( "id", "praia_fav_" + json_response_fav[i].fav_praia );
                                            
                                            /* span das notas para cada praia da lista*/
                                            var span_div = document.createElement( "div" );
                                            span_div.setAttribute( "class", "span_nota" );
                                            for ( var cor = 0 ; cor < cores.length; cor++ )
                                            {
                                                var nota_span = document.createElement ( "span" );							
                                                var nota_node = document.createTextNode ( "0" );
                                                nota_span.setAttribute( "class", "span_" + cor + "_" + json_response_fav[i].fav_praia );
                                                nota_span.appendChild( nota_node );
                                                span_div.appendChild( nota_span );
                                                nota_span.style.color = cores[cor].nota_cor ;
                                                if ( cor < cores.length - 1  )
                                                {	
                                                    var nota_sep = document.createElement ( "span" );                       
                                                    var nota_sep_node = document.createTextNode ( " / " );
                                                    nota_sep.appendChild( nota_sep_node );
                                                    span_div.appendChild( nota_sep );
                                                }							
                                            }
                                            praia.appendChild( span_div );
                                            var id_full = "#praia_fav_" + json_response_fav[i].fav_praia
                                            var id_ind =  id_full.lastIndexOf( '_' ) + 1 ;
                                            var id = id_full.substr( id_ind );                                            
                                            praia.setAttribute( "onclick", "favProfile(" + id + ");" );
                                            
                                            document.getElementById( "fav_praias_div" ).appendChild( praia );
                                            
                                            $("#" + "fav_praias_div" ).trigger('create');
                                        }
                                        
                                        localStorage.setItem( "FAV_LIST", JSON.stringify( fav_array ) );
                                        
                                    }
                                    
                                    if( fav_array.length == 0 )
                                    {
                                        alert("Você não possui nenhuma praia como favorita. Favorite pelo menos uma praia antes de entrar nessa sessão.");
                                    }
                                    else if ( fav_array.length > 0 )
                                    {
                                        $("body").pagecontainer("change", "#favoritos_page");
                                    }
                                    
                                },
                                error: function(jqXHR, textStatus, errorThrown) 
                                {
                                    alert( "Erro com o ajax, por favor verifique a conectividade.")
                                }
                            });
                        }
                        
                    );
                    
                    $( "#logon" ).click(
                        function ( )
                        {
                            $(this).addClass( 'ui-disabled' );
                            $("body").pagecontainer("change", "#loading");
                            if( document.getElementById("anon_box").checked )
                            {
                                var json_array = 
                                    [
                                        {                                 		
                                            "usr_login" : "anonimo" ,
                                            "usr_senha" : "anonimo"
                                        }
                                    ]; 
                            }
                            else
                            {
                                var json_array = 
                                    [
                                        {                                 		
                                            "usr_login" : document.getElementById("logon_usr").value ,
                                            "usr_senha" : document.getElementById("logon_senha").value
                                        }
                                    ];
                            }
                            
                            var json_str = JSON.stringify( json_array );        			
                            $.ajax
                            ({
                                type: 'POST',
                                crossDomain: true,
                                url: 'http://surfer2surfer.com.br/logon.php',
                                data : json_str,
                                success: function( data )
                                {                            
                                    var json_response = JSON.parse( data );                            
                                    if( json_response[0].status == 0 )
                                    {
                                        alert(json_response[0].msg);
                                        document.getElementById("logon_usr").value = "";
                                        document.getElementById("logon_senha").value = "";
                                        $( "#logon" ).removeClass( 'ui-disabled' );
                                        logOut( );
                                    }
                                    else
                                    {                                
                                        localStorage.setItem( 'USR_ID', json_response[0].usr_id );
                                        localStorage.setItem( 'USR_NOME', json_response[0].usr_nome );
                                        localStorage.setItem( 'USR_MAX_FAV', json_response[0].usr_max_fav);
                                        localStorage.setItem( 'USR_PROC', json_response[0].usr_proc);
                                        
                                        var json_fav = 
                                            [
                                                {  
                                                    "usr_id": localStorage.getItem( 'USR_ID' )                                        
                                                }
                                            ];
                                        
                                        var json_fav_str = JSON.stringify( json_fav );
                                        
                                        if( localStorage.getItem( 'USR_ID' ) != 1 )
                                        {
                                            if( localStorage.getItem( "USR_PROC" ) == 1 )
                                            {
                                                $( "#not_para" ).show( ).css( "display", "block" );                                          
                                            }
                                            
                                            else
                                            {
                                                $( "#not_receb" ).show( ).css( "display", "block" );
                                            }
                                            $( "#fav_refresh" ).show( ).css( "display", "block" );                                           
                                            //$( "#anon_com" ).show( );
                                            //$( "#anon_com_label" ).show( );
                                            $( "#fav_button" ).show( ).css( "display", "block" );
                                            
                                            //$( "#anon_com" ).hide( );
                                            //$( "#anon_com_label" ).hide( );                                            
                                            
                                            ajax_not_setInterval( json_fav_str, parseInt( localStorage.getItem( 'USR_ID' ) ) );
                                            ajax_call_not( json_fav_str, parseInt( localStorage.getItem( 'USR_ID' ) ) );
                                            
                                            $.ajax
                                            ({
                                                type: 'POST',
                                                crossDomain: true,
                                                url: 'http://surfer2surfer.com.br/json_lista_fav.php',
                                                data : json_fav_str,
                                                success: function( data )
                                                {
                                                    var json_response_fav = JSON.parse( data );
                                                    var fav_array = new Array( );
                                                    
                                                    
                                                    for ( var i = 0; i < json_response_fav.length; i++ )
                                                    {
                                                        var json_id_praia_fav = 
                                                            [
                                                                { "praia_id"	: json_response_fav[i].fav_praia }
                                                            ];
                                                        var json_id_praia_fav_str = JSON.stringify( json_id_praia_fav );
                                                        
                                                        fav_array[ json_response_fav[i].fav_praia ] = 1;
                                                        
                                                        ajax_lista_setInterval( json_id_praia_fav_str, parseInt( json_response_fav[i].fav_praia ) );
                                                        ajax_call_lista( json_id_praia_fav_str, parseInt( json_response_fav[i].fav_praia ) );
                                                    }
                                                    
                                                    localStorage.setItem( "FAV_LIST", JSON.stringify( fav_array ) );
                                                    
                                                },
                                                error: function(jqXHR, textStatus, errorThrown) 
                                                {
                                                    logOut( ); 
                                                    alert( "Erro com o ajax, por favor verifique a conectividade.")
                                                }
                                            });
                                        }
                                        else
                                        {                                            
                                            $( "#feed_cont" ).hide( );
                                            $( "#fav_refresh" ).hide( );
                                            $( "#not_receb" ).hide( );
                                            $( "#not_para" ).hide( );
                                            //$( "#anon_com" ).hide( );
                                            //$( "#anon_com_label" ).hide( );
                                            $( "#fav_button" ).hide( );
                                        }
                                        
                                        $( "#fb_post_label" ).hide( );
                                        $( "#fb_post" ).hide( );
                                        document.getElementById("usr_nome_txt").appendChild( document.createTextNode( localStorage.getItem( 'USR_NOME' ) ) );
                                        $("body").pagecontainer("change", "#user_panel");
                                        $( "#logon" ).removeClass( 'ui-disabled' );
                                        document.getElementById("logon_usr").value = "";
                                        document.getElementById("logon_senha").value = "";
                                        $( "#anon_box" ).prop( "checked", false ).checkboxradio( "refresh" );
                                        
                                    }
                                    
                                },
                                error: function(jqXHR, textStatus, errorThrown) 
                                {
                                    logOut( );
                                    alert( "Erro com o ajax, por favor verifique a conectividade.");
                                }
                            });
                        });
                    
                    $( "#register" ).click(
                        function ( )
                        {
                            if ( document.getElementById("senha_usr").value != document.getElementById("senha_usr_conf").value )
                            {
                                alert("As senhas não coincidem.");
                                return;
                            }
                            if( !verifyEmail() )
                            {                            
                                return;
                            }                   
                            
                            var json_array = 
                                [
                                    {  
                                        "usr_nome"	: document.getElementById("nome_usr").value ,
                                        "usr_login" : document.getElementById("login_usr").value ,
                                        "usr_senha" : document.getElementById("senha_usr").value ,
                                        "usr_mail" : document.getElementById("mail_usr").value
                                    }
                                ];
                            
                            var json_str = JSON.stringify( json_array );        			
                            $.ajax
                            ({
                                type: 'POST',
                                crossDomain: true,
                                url: 'http://surfer2surfer.com.br/cadastro_handler.php',
                                data : json_str,
                                success: function( data )
                                {
                                    var json_response = JSON.parse( data );
                                    alert(json_response[0].msg);
                                    if( json_response[0].status == 1 )
                                    {
                                        document.getElementById("nome_usr").value = "";
                                        document.getElementById("login_usr").value = "";
                                        document.getElementById("senha_usr").value = "";
                                        document.getElementById("senha_usr_conf").value = "";
                                        document.getElementById("mail_usr").value = "";
                                        document.getElementById("mail_usr_conf").value = "";
                                        $("body").pagecontainer("change", "#login_page");
                                    }
                                    
                                },
                                error: function(jqXHR, textStatus, errorThrown) 
                                {
                                    alert( "Erro com o ajax, por favor verifique a conectividade.")
                                }
                            });
                        });
                    
                    
                    $( ".praia" ).click(
                        function ( )
                        {
                            var id_full = $( this ).attr( 'id' );
                            var id_ind =  id_full.indexOf( '_' ) + 1 ;
                            var id = id_full.substr( id_ind );
                            var json_array = 
                                [
                                    { "praia_id"	: id }
                                ];
                            
                            
                            var json_str = JSON.stringify( json_array );
                            ajax_setInterval( json_str, parseInt( id ) );
                            ajax_setInterval_span( json_str, parseInt( id ) );						                       
                            call_span_profile( json_str, parseInt( id ) );
                            ajax_call( json_str, parseInt( id ) );
                            localStorage.setItem( "CUR_PRAIA", parseInt( id ) );
                            dadosProfile( );
                            
                            if( localStorage.getItem( "FB" ) == 1 )
                            {
                                document.getElementById( "fb_post" ).checked = true;
                            }
                            
                            var id_page_string = $( this ).closest( "div" ).attr( "id" );
                            var id_page_ind =  id_page_string.lastIndexOf( '_' ) + 1 ;
                            var id_page = id_page_string.substr( id_page_ind );
                            
                            localStorage.setItem( "VOLTA_ESTADO", id_page );                       
                            
                            $("body").pagecontainer("change", "#praia_profile"); 
                        }
                        
                    );
                    
                    $( "#comment_submit" ).click(
                        function ( event )
                        {
                            $( "#comment_submit" ).addClass( "ui-disabled" );
                            var tam_id;
                            var tam_onda_com = document.getElementById( "tam_slide" ).value - 0;
                            if( !$( "input[name*=nota]:checked" ).val( ) )
                            {
                                alert( "Você precisa dar uma nota!" );
                                $( "#comment_submit" ).removeClass( "ui-disabled" );
                                return;                           
                            }                       
                            for ( var ta = 0 ; ta < tam.length ; ta++ )
                            {
                                var tam_onda_comp = tam[ta].onda_tam - 0;
                                if ( tam_onda_com == tam_onda_comp )
                                {
                                    tam_id = tam[ta].id_tam;
                                }
                                
                            }
                            if( !( document.getElementById( "anon_com" ).checked ) )
                            {    
                                var json_array = 
                                    [
                                        { 	
                                            "comment_val" : $("#comment_box").val( ) ,
                                            "praia_id"	: localStorage.getItem( "CUR_PRAIA" ),
                                            "usr_id" :  localStorage.getItem( "USR_ID" ),
                                            "nota_id" : $("input[name*=nota]:checked").val( ),
                                            "tam_id" : tam_id
                                        }
                                    ];
                            }
                            else
                            {
                                var json_array = 
                                    [
                                        { 	
                                            "comment_val" : $("#comment_box").val( ) ,
                                            "praia_id"	: localStorage.getItem( "CUR_PRAIA" ),
                                            "usr_id" :  1,
                                            "nota_id" : $( "input[name*=nota]:checked" ).val( ),
                                            "tam_id" : tam_id
                                        }
                                    ]; 
                            }
                            
                            
                            var json_str = JSON.stringify( json_array );
                            $.ajax
                            ({
                                type: 'POST',
                                crossDomain: true,
                                url: 'http://surfer2surfer.com.br/json_handler_comment.php',
                                data : json_str,
                                success: function( data )
                                {                           
                                    document.getElementById( "anon_com" ).value = false;
                                    $( "#comment_box" ).val( "" );                              
                                    localStorage.setItem( "COM_LAST_ID", data );
                                    if( document.getElementById( "so_img" ).checked )
                                    {
                                        capturePhoto( ); 
                                    }
                                    else
                                    {
                                        if ( confirm( "Comentário enviado com Sucesso! Deseja tirar uma foto agora?" ) ) 
                                        {
                                            capturePhoto( );
                                        }
                                        
                                        else 
                                        {
                                            $( "#comment_submit" ).removeClass( "ui-disabled" );
                                        }
                                    }
                                    
                                },
                                error: function(jqXHR, textStatus, errorThrown) 
                                {
                                    alert( "Erro com o ajax, por favor verifique a conectividade.")
                                }
                            });
                        }
                        
                    ); 
                    
                    $( ".com_show_hide" ).click(
                        function( )
                        {
                            $( "#feed_cont" ).toggle( );
                            if( localStorage.getItem( 'profile_com' ) == 1 )
                            {
                                localStorage.setItem( 'profile_com', 0 );
                                $( ".com_show_hide" ).html( "Esconder Comentários" );
                            }                        
                            else
                            {
                                localStorage.setItem( 'profile_com', 1 );
                                $( ".com_show_hide" ).html( "Mostrar Comentários" ); 
                            }
                        }
                    );
                    $( "#so_img" ).click( 
                        function ( )
                        {
                            if( $( "#comment_box" ).hasClass( "ui-disabled" ) )
                            {
                                $( "#comment_box" ).removeClass( "ui-disabled" );                             
                            }
                            else
                            {
                                $( "#comment_box" ).addClass( "ui-disabled" );
                                $( "#comment_box" ).val( "" );
                            }
                        }
                    );                    
                    
                    
                    $( "#not_receb" ).click(
                        function ( )
                        {
                            
                            var json_array = 
                                [
                                    {
                                        "usr_id" :  localStorage.getItem( "USR_ID" ),
                                        "recebe" : 1
                                    }
                                ];
                            
                            var json_str = JSON.stringify( json_array );
                            
                            
                            $.ajax
                            ({
                                type: 'POST',
                                crossDomain: true,
                                url: 'http://surfer2surfer.com.br/notifica.php',
                                data : json_str,
                                success: function( )
                                {                           
                                    $( "#not_receb" ).hide( );
                                    localStorage.setItem( "USR_PROC" , 1 );
                                    $( "#not_para" ).show( );
                                    
                                    
                                },
                                error: function(jqXHR, textStatus, errorThrown) 
                                {
                                    alert( "Erro com o ajax, por favor verifique a conectividade.")
                                }
                            });
                        }
                    );
                    
                    $( "#not_para" ).click(
                        function ( )
                        {
                            var json_array = 
                                [
                                    {
                                        "usr_id" :  localStorage.getItem( "USR_ID" ),
                                        "recebe" : 0
                                    }
                                ];
                            
                            var json_str = JSON.stringify( json_array );
                            
                            
                            $.ajax
                            ({
                                type: 'POST',
                                crossDomain: true,
                                url: 'http://surfer2surfer.com.br/notifica.php',
                                data : json_str,
                                success: function( )
                                { 
                                    $( "#not_para" ).hide( );
                                    localStorage.setItem( "USR_PROC" , 0 );
                                    $( "#not_receb" ).show( );                                    
                                    
                                },
                                error: function(jqXHR, textStatus, errorThrown) 
                                {
                                    alert( "Erro com o ajax, por favor verifique a conectividade.")
                                }
                            });
                        }
                    );
                });
            /*
                    $( "#nota_profile_hide" ).click( 
                        function ( )
                        {
                            if( localStorage.getItem( 'profile_notas' ) == 1 )
                            {
                                $( "#nota_profile_notas" ).toggle( );
                                $( "#nota_profile_slide" ).animate({width: "100%"}, 100);
                                $( "#nota_profile_notas" ).animate({width: "0%"}, 100);
                                localStorage.setItem( 'profile_notas', 0 );
                                $( "#nota_profile_hide" ).html( "Diminuir" );
                            }
                            
                            else
                            {
                                $( "#nota_profile_notas" ).toggle( );
                                $( "#nota_profile_slide" ).animate({width: "50%"}, 100);
                                $( "#nota_profile_notas" ).animate({width: "50%"}, 100);
                                localStorage.setItem( 'profile_notas', 1 );
                                $( "#nota_profile_hide" ).html( "Expandir" );
                            }
                        });   */             
            
            
            
            
        </script>
        <script src="http://surfer2surfer.com.br/tam_ondas.php?callback=tam_receiver"></script>
        <script src="http://surfer2surfer.com.br/json_cores.php?callback=cores_receiver"></script>
        <script src="http://surfer2surfer.com.br/json_notas.php?callback=notas_receiver"></script>
        <script src="http://surfer2surfer.com.br/json_praias.php?callback=praias_receiver"></script>
        <script src="http://surfer2surfer.com.br/json_cidades.php?callback=cidades_receiver"></script>
        <script src="http://surfer2surfer.com.br/json_estados.php?callback=estados_receiver"></script>
        <script type="text/javascript" charset="utf-8" src="scripts/jso.js"></script>
        <script type="text/javascript" charset="utf-8" src="scripts/main.js"></script>
        
    </body>
</html>
